!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=13)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.x=e.x,this.y=e.y,this.z=e.z}static fromCoord2(e){return new n({x:e.x,y:e.y,z:0})}scaled(e){return n.scale(this,e)}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalized(){return n.scale(this,1/this.length())}static distance(e,t){return n.subtract(e,t).length()}static add(e,t){return new n({x:e.x+t.x,y:e.y+t.y,z:e.z+t.z})}static subtract(e,t){return new n({x:e.x-t.x,y:e.y-t.y,z:e.z-t.z})}static scale(e,t){return new n({x:e.x*t,y:e.y*t,z:e.z*t})}static interpolate(e,t,r){return n.add(n.scale(e,1-r),n.scale(t,r))}}t.Coord3=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2),o=r(0);function i(e){const t=[{uAxis:new o.Coord3({x:0,y:1,z:0}),vAxis:new o.Coord3({x:0,y:0,z:1}),normal:new o.Coord3({x:1,y:0,z:0})},{uAxis:new o.Coord3({x:0,y:-1,z:0}),vAxis:new o.Coord3({x:0,y:0,z:1}),normal:new o.Coord3({x:-1,y:0,z:0})},{uAxis:new o.Coord3({x:-1,y:0,z:0}),vAxis:new o.Coord3({x:0,y:0,z:1}),normal:new o.Coord3({x:0,y:1,z:0})},{uAxis:new o.Coord3({x:1,y:0,z:0}),vAxis:new o.Coord3({x:0,y:0,z:1}),normal:new o.Coord3({x:0,y:-1,z:0})},{uAxis:new o.Coord3({x:1,y:0,z:0}),vAxis:new o.Coord3({x:0,y:1,z:0}),normal:new o.Coord3({x:0,y:0,z:1})},{uAxis:new o.Coord3({x:1,y:0,z:0}),vAxis:new o.Coord3({x:0,y:-1,z:0}),normal:new o.Coord3({x:0,y:0,z:-1})}];return a([].concat(...t.map(({uAxis:t,vAxis:r,normal:n})=>(function(t,r,n){const i=[];for(let a=0;a<=e;++a){const s=a/e;i[a]=[];for(let u=0;u<=e;++u){const c=u/e,f=o.Coord3.add(o.Coord3.add(t.scaled(2*c-1),r.scaled(2*s-1)),n);i[a][u]={position:f,normal:n,texCoord:f.normalized()}}}const a=[];for(let t=0;t<e;++t)for(let r=0;r<e;++r)a.push([i[t+0][r+0],i[t+0][r+1],i[t+1][r+0]]),a.push([i[t+1][r+0],i[t+0][r+1],i[t+1][r+1]]);return a})(t,r,n))))}function a(e){const t=[],r=[];for(const n of e)t.push(n.map(e=>{const t=r.find(t=>s(t,e));return r.push(e),t||e}));return t}function s(e,t){return["position","normal","texCoord"].every(r=>o.Coord3.distance(e[r],t[r])<1e-5)}function u(e){return[e.x,e.y,e.z]}t.waitMs=function*(e){let t=0;for(;t<e;)t+=(yield);return t},t.animateInterpolation=function*(e,t){let r=0;for(;r<e;)t(r/e),r+=(yield);return t(1),r},t.parallel=function*(e){let t=e.slice();for(;t.length;){const e=yield;for(let r=0;r<t.length;++r)t[r].next(e).done&&t.splice(r,1)}},t.easings={inOutCubic:(e,t=0,r=1,n=1)=>(e/=n/2)<1?r/2*e*e*e+t:r/2*((e-=2)*e*e+2)+t,easeOutCubic:(e,t=0,r=1,n=1)=>(e/=n,r*(--e*e*e+1)+t)},t.range=function*(e,t){for(let r=e;r<t;++r)yield r},t.randomElement=function(e){return e[Math.floor(Math.random()*e.length)]},t.fisherYatesArrayShuffle=function(e){let t=e.length;if(0!==t)for(;--t;){const r=Math.floor(Math.random()*(t+1)),n=e[t],o=e[r];e[t]=o,e[r]=n}},t.makeTesselatedCubeMesh=i,t.makeTesselatedSphereMesh=function(e,t){return a(i(t).map(t=>t.map(t=>{const r=t.position.normalized();return{position:r.scaled(e),normal:r,texCoord:t.texCoord}})))},t.meshToWebglArrays=function(e){const t=[],r=[];for(const n of e)for(const e of n){const n=t.indexOf(e);-1!=n?r.push(n):r.push(t.push(e)-1)}return{position:{numComponents:3,data:t.map(e=>e.position).map(u).reduce((e,t)=>(e.push(...t),e),[])},normal:{numComponents:3,data:t.map(e=>e.normal).map(u).reduce((e,t)=>(e.push(...t),e),[])},texCoord:{numComponents:3,data:t.map(e=>e.texCoord).map(u).reduce((e,t)=>(e.push(...t),e),[])},indices:{numComponents:3,data:r}}},t.axisRotate=function(e,t,r){return function(e){return new o.Coord3({x:e[0],y:e[1],z:e[2]})}(n.m4.transformPoint(n.m4.axisRotate(n.m4.identity(),u(e),r/360*2*Math.PI),u(t)))}},function(e,t,r){
/*!
 * @license twgl.js 4.4.0 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
 * Available via the MIT license.
 * see: http://github.com/greggman/twgl.js for details
 */
var n;"undefined"!=typeof self&&self,n=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=9)}([function(e,t,r){"use strict";t.__esModule=!0,t.copyExistingProperties=function(e,t){Object.keys(t).forEach(function(r){t.hasOwnProperty(r)&&e.hasOwnProperty(r)&&(t[r]=e[r])})},t.copyNamedProperties=function(e,t,r){e.forEach(function(e){var n=t[e];void 0!==n&&(r[e]=n)})},t.isBuffer=function(e,t){a||(a=e.createBuffer());return t instanceof a.constructor},t.isRenderbuffer=function(e,t){s||(s=e.createRenderbuffer());return t instanceof s.constructor},t.isShader=function(e,t){u||(u=e.createShader(e.VERTEX_SHADER));return t instanceof u.constructor},t.isTexture=function(e,t){c||(c=e.createTexture());return t instanceof c.constructor},t.isSampler=function(e,t){if(!f){if(!e.createSampler)return!1;f=e.createSampler()}return t instanceof f.constructor},t.warn=t.error=void 0;var n,o=(n=r(2))&&n.__esModule?n:{default:n};var i=o.default.console&&o.default.console.error&&"function"==typeof o.default.console.error?o.default.console.error.bind(o.default.console):function(){};t.error=i;var a,s,u,c,f,l=o.default.console&&o.default.console.warn&&"function"==typeof o.default.console.warn?o.default.console.warn.bind(o.default.console):function(){};t.warn=l},function(e,t,r){"use strict";t.__esModule=!0,t.getGLTypeForTypedArray=function(e){if(e instanceof Int8Array)return i;if(e instanceof Uint8Array)return a;if(e instanceof Uint8ClampedArray)return a;if(e instanceof Int16Array)return s;if(e instanceof Uint16Array)return u;if(e instanceof Int32Array)return c;if(e instanceof Uint32Array)return f;if(e instanceof Float32Array)return l;throw"unsupported typed array type"},t.getGLTypeForTypedArrayType=function(e){if(e===Int8Array)return i;if(e===Uint8Array)return a;if(e===Uint8ClampedArray)return a;if(e===Int16Array)return s;if(e===Uint16Array)return u;if(e===Int32Array)return c;if(e===Uint32Array)return f;if(e===Float32Array)return l;throw"unsupported typed array type"},t.getTypedArrayTypeForGLType=function(e){var t=d[e];if(!t)throw"unknown gl type";return t},t.isArrayBuffer=void 0;var n,o=(n=r(2))&&n.__esModule?n:{default:n};var i=5120,a=5121,s=5122,u=5123,c=5124,f=5125,l=5126,d={},m=d;m[i]=Int8Array,m[a]=Uint8Array,m[s]=Int16Array,m[u]=Uint16Array,m[c]=Int32Array,m[f]=Uint32Array,m[l]=Float32Array,m[32819]=Uint16Array,m[32820]=Uint16Array,m[33635]=Uint16Array,m[5131]=Uint16Array,m[33640]=Uint32Array,m[35899]=Uint32Array,m[35902]=Uint32Array,m[36269]=Uint32Array,m[34042]=Uint32Array;var p=o.default.SharedArrayBuffer?function(e){return e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof o.default.SharedArrayBuffer)}:function(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer};t.isArrayBuffer=p},function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=void 0!==n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};t.default=n},function(e,t,r){"use strict";t.__esModule=!0,t.add=function(e,t,r){return(r=r||new n(3))[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r},t.copy=function(e,t){return(t=t||new n(3))[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.create=function(e,t,r){var o=new n(3);e&&(o[0]=e);t&&(o[1]=t);r&&(o[2]=r);return o},t.cross=function(e,t,r){r=r||new n(3);var o=e[2]*t[0]-e[0]*t[2],i=e[0]*t[1]-e[1]*t[0];return r[0]=e[1]*t[2]-e[2]*t[1],r[1]=o,r[2]=i,r},t.distance=function(e,t){var r=e[0]-t[0],n=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(r*r+n*n+o*o)},t.distanceSq=function(e,t){var r=e[0]-t[0],n=e[1]-t[1],o=e[2]-t[2];return r*r+n*n+o*o},t.divide=function(e,t,r){return(r=r||new n(3))[0]=e[0]/t[0],r[1]=e[1]/t[1],r[2]=e[2]/t[2],r},t.divScalar=function(e,t,r){return(r=r||new n(3))[0]=e[0]/t,r[1]=e[1]/t,r[2]=e[2]/t,r},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},t.lerp=function(e,t,r,o){return(o=o||new n(3))[0]=(1-r)*e[0]+r*t[0],o[1]=(1-r)*e[1]+r*t[1],o[2]=(1-r)*e[2]+r*t[2],o},t.length=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])},t.lengthSq=function(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]},t.mulScalar=function(e,t,r){return(r=r||new n(3))[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r},t.multiply=function(e,t,r){return(r=r||new n(3))[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r},t.negate=function(e,t){return(t=t||new n(3))[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},t.normalize=function(e,t){t=t||new n(3);var r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],o=Math.sqrt(r);o>1e-5?(t[0]=e[0]/o,t[1]=e[1]/o,t[2]=e[2]/o):(t[0]=0,t[1]=0,t[2]=0);return t},t.setDefaultType=function(e){var t=n;return n=e,t},t.subtract=function(e,t,r){return(r=r||new n(3))[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r};var n=Float32Array},function(e,t,r){"use strict";t.__esModule=!0,t.isWebGL1=function(e){return!e.texStorage2D},t.isWebGL2=function(e){return!!e.texStorage2D},t.glEnumToString=void 0;var n=function(){var e={},t={};return function(r,n){return function(r){var n=r.constructor.name;if(!e[n]){for(var o in r)if("number"==typeof r[o]){var i=t[r[o]];t[r[o]]=i?"".concat(i," | ").concat(o):o}e[n]=!0}}(r),t[n]||"0x"+n.toString(16)}}();t.glEnumToString=n},function(e,t,r){"use strict";t.__esModule=!0,t.createAttributeSetters=X,t.createProgram=B,t.createProgramFromScripts=function(e,t,r,n,o){for(var i=R(r,n,o),a=[],s=0;s<t.length;++s){var u=I(e,t[s],e[w[s]],i.errorCallback);if(!u)return null;a.push(u)}return B(e,a,i)},t.createProgramFromSources=U,t.createProgramInfo=function(e,t,r,n,o){var i=R(r,n,o),a=!0;if(t=t.map(function(e){if(e.indexOf("\n")<0){var t=f(e);t?e=t.text:(i.errorCallback("no element with id: "+e),a=!1)}return e}),!a)return null;var s=U(e,t,i);if(!s)return null;return V(e,s)},t.createProgramInfoFromProgram=V,t.createUniformSetters=S,t.createUniformBlockSpecFromProgram=D,t.createUniformBlockInfoFromProgram=N,t.createUniformBlockInfo=function(e,t,r){return N(e,t.program,t.uniformBlockSpec,r)},t.createTransformFeedback=function(e,t,r){var n=e.createTransformFeedback();return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n),e.useProgram(t.program),z(e,t,r),e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),function(e,t,r){for(var n in t.transformFeedbackInfo&&(t=t.transformFeedbackInfo),r.attribs&&(r=r.attribs),r){var o=t[n];o&&e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,o.index,null)}}(e,t,r),n},t.createTransformFeedbackInfo=k,t.bindTransformFeedbackInfo=z,t.setAttributes=G,t.setBuffersAndAttributes=function(e,t,r){r.vertexArrayObject?e.bindVertexArray(r.vertexArrayObject):(G(t.attribSetters||t,r.attribs),r.indices&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.indices))},t.setUniforms=function e(t,r){var n=t.uniformSetters||t;var o=arguments.length;for(var i=1;i<o;++i){var a=arguments[i];if(Array.isArray(a))for(var s=a.length,u=0;u<s;++u)e(n,a[u]);else for(var c in a){var f=n[c];f&&f(a[c])}}},t.setUniformBlock=function(e,t,r){j(e,t,r)&&e.bufferData(e.UNIFORM_BUFFER,r.array,e.DYNAMIC_DRAW)},t.setBlockUniforms=function(e,t){var r=e.uniforms;for(var n in t){var o=r[n];if(o){var i=t[n];i.length?o.set(i):o[0]=i}}},t.bindUniformBlock=j;var n,o=s(r(4)),i=s(r(0)),a=(n=r(2))&&n.__esModule?n:{default:n};function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var u=i.error,c=i.warn,f=a.default&&a.default.document&&a.default.document.getElementById?a.default.document.getElementById.bind(a.default.document):function(){return null},l={};function d(e,t){return l[t].bindPoint}function m(e,t){return function(r){e.uniform1i(t,r)}}function p(e,t){return function(r){e.uniform1iv(t,r)}}function h(e,t){return function(r){e.uniform2iv(t,r)}}function y(e,t){return function(r){e.uniform3iv(t,r)}}function v(e,t){return function(r){e.uniform4iv(t,r)}}function b(e,t,r,n){var a=d(0,t);return o.isWebGL2(e)?function(t){var o,s;i.isTexture(e,t)?(o=t,s=null):(o=t.texture,s=t.sampler),e.uniform1i(n,r),e.activeTexture(e.TEXTURE0+r),e.bindTexture(a,o),e.bindSampler(r,s)}:function(t){e.uniform1i(n,r),e.activeTexture(e.TEXTURE0+r),e.bindTexture(a,t)}}function E(e,t,r,n,a){for(var s=d(0,t),u=new Int32Array(a),c=0;c<a;++c)u[c]=r+c;return o.isWebGL2(e)?function(t){e.uniform1iv(n,u),t.forEach(function(t,n){var o,a;e.activeTexture(e.TEXTURE0+u[n]),i.isTexture(e,t)?(o=t,a=null):(o=t.texture,a=t.sampler),e.bindSampler(r,a),e.bindTexture(s,o)})}:function(t){e.uniform1iv(n,u),t.forEach(function(t,r){e.activeTexture(e.TEXTURE0+u[r]),e.bindTexture(s,t)})}}function _(e,t){return function(r){e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,r.numComponents||r.size,r.type||e.FLOAT,r.normalize||!1,r.stride||0,r.offset||0),void 0!==r.divisor&&e.vertexAttribDivisor(t,r.divisor)}}function x(e,t){return function(r){e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,r.numComponents||r.size,r.type||e.INT,r.stride||0,r.offset||0),void 0!==r.divisor&&e.vertexAttribDivisor(t,r.divisor)}}function g(e,t,r){var n=r.size,o=r.count;return function(r){e.bindBuffer(e.ARRAY_BUFFER,r.buffer);for(var i=r.size||r.numComponents||n,a=i/o,s=r.type||e.FLOAT,u=l[s].size*i,c=r.normalize||!1,f=r.offset||0,d=u/o,m=0;m<o;++m)e.enableVertexAttribArray(t+m),e.vertexAttribPointer(t+m,a,s,c,u,f+d*m),void 0!==r.divisor&&e.vertexAttribDivisor(t+m,r.divisor)}}l[5126]={Type:Float32Array,size:4,setter:function(e,t){return function(r){e.uniform1f(t,r)}},arraySetter:function(e,t){return function(r){e.uniform1fv(t,r)}}},l[35664]={Type:Float32Array,size:8,setter:function(e,t){return function(r){e.uniform2fv(t,r)}}},l[35665]={Type:Float32Array,size:12,setter:function(e,t){return function(r){e.uniform3fv(t,r)}}},l[35666]={Type:Float32Array,size:16,setter:function(e,t){return function(r){e.uniform4fv(t,r)}}},l[5124]={Type:Int32Array,size:4,setter:m,arraySetter:p},l[35667]={Type:Int32Array,size:8,setter:h},l[35668]={Type:Int32Array,size:12,setter:y},l[35669]={Type:Int32Array,size:16,setter:v},l[5125]={Type:Uint32Array,size:4,setter:function(e,t){return function(r){e.uniform1ui(t,r)}},arraySetter:function(e,t){return function(r){e.uniform1uiv(t,r)}}},l[36294]={Type:Uint32Array,size:8,setter:function(e,t){return function(r){e.uniform2uiv(t,r)}}},l[36295]={Type:Uint32Array,size:12,setter:function(e,t){return function(r){e.uniform3uiv(t,r)}}},l[36296]={Type:Uint32Array,size:16,setter:function(e,t){return function(r){e.uniform4uiv(t,r)}}},l[35670]={Type:Uint32Array,size:4,setter:m,arraySetter:p},l[35671]={Type:Uint32Array,size:8,setter:h},l[35672]={Type:Uint32Array,size:12,setter:y},l[35673]={Type:Uint32Array,size:16,setter:v},l[35674]={Type:Float32Array,size:16,setter:function(e,t){return function(r){e.uniformMatrix2fv(t,!1,r)}}},l[35675]={Type:Float32Array,size:36,setter:function(e,t){return function(r){e.uniformMatrix3fv(t,!1,r)}}},l[35676]={Type:Float32Array,size:64,setter:function(e,t){return function(r){e.uniformMatrix4fv(t,!1,r)}}},l[35685]={Type:Float32Array,size:24,setter:function(e,t){return function(r){e.uniformMatrix2x3fv(t,!1,r)}}},l[35686]={Type:Float32Array,size:32,setter:function(e,t){return function(r){e.uniformMatrix2x4fv(t,!1,r)}}},l[35687]={Type:Float32Array,size:24,setter:function(e,t){return function(r){e.uniformMatrix3x2fv(t,!1,r)}}},l[35688]={Type:Float32Array,size:48,setter:function(e,t){return function(r){e.uniformMatrix3x4fv(t,!1,r)}}},l[35689]={Type:Float32Array,size:32,setter:function(e,t){return function(r){e.uniformMatrix4x2fv(t,!1,r)}}},l[35690]={Type:Float32Array,size:48,setter:function(e,t){return function(r){e.uniformMatrix4x3fv(t,!1,r)}}},l[35678]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:3553},l[35680]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:34067},l[35679]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:32879},l[35682]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:3553},l[36289]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:35866},l[36292]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:35866},l[36293]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:34067},l[36298]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:3553},l[36299]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:32879},l[36300]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:34067},l[36303]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:35866},l[36306]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:3553},l[36307]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:32879},l[36308]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:34067},l[36311]={Type:null,size:0,setter:b,arraySetter:E,bindPoint:35866};var T={};T[5126]={size:4,setter:_},T[35664]={size:8,setter:_},T[35665]={size:12,setter:_},T[35666]={size:16,setter:_},T[5124]={size:4,setter:x},T[35667]={size:8,setter:x},T[35668]={size:12,setter:x},T[35669]={size:16,setter:x},T[5125]={size:4,setter:x},T[36294]={size:8,setter:x},T[36295]={size:12,setter:x},T[36296]={size:16,setter:x},T[35670]={size:4,setter:x},T[35671]={size:8,setter:x},T[35672]={size:12,setter:x},T[35673]={size:16,setter:x},T[35674]={size:4,setter:g,count:2},T[35675]={size:9,setter:g,count:3},T[35676]={size:16,setter:g,count:4};var A=void 0;var P=/^[ \t]*\n/;function C(e,t,r,n){var o=n||u,i=e.createShader(r),a=0;if(P.test(t)&&(a=1,t=t.replace(P,"")),e.shaderSource(i,t),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){var s=e.getShaderInfoLog(i);return o(function(e,t){return t=t||0,++t,e.split("\n").map(function(e,r){return r+t+": "+e}).join("\n")}(t,a)+"\n*** Error compiling shader: "+s),e.deleteShader(i),null}return i}function R(e,t,r){var n;if("function"==typeof t&&(r=t,t=void 0),"function"==typeof e)r=e,e=void 0;else if(e&&!Array.isArray(e)){if(e.errorCallback)return e;var o=e;r=o.errorCallback,e=o.attribLocations,n=o.transformFeedbackVaryings}var i={errorCallback:r||u,transformFeedbackVaryings:n};if(e){var a={};Array.isArray(e)?e.forEach(function(e,r){a[e]=t?t[r]:r}):a=e,i.attribLocations=a}return i}var w=["VERTEX_SHADER","FRAGMENT_SHADER"];function F(e){return e.indexOf("frag")>=0?A.FRAGMENT_SHADER:e.indexOf("vert")>=0?A.VERTEX_SHADER:void 0}function M(e,t){t.forEach(function(t){e.deleteShader(t)})}function B(e,t,r,n,o){for(var a=R(r,n,o),s=[],u=[],c=0;c<t.length;++c){var l=t[c];if("string"==typeof l){var d=f(l),m=d?d.text:l,p=e[w[c]];d&&d.type&&(p=F(d.type)||p),l=C(e,m,p,a.errorCallback),u.push(l)}i.isShader(e,l)&&s.push(l)}if(s.length!==t.length)return a.errorCallback("not enough shaders for program"),M(e,u),null;var h=e.createProgram();s.forEach(function(t){e.attachShader(h,t)}),a.attribLocations&&Object.keys(a.attribLocations).forEach(function(t){e.bindAttribLocation(h,a.attribLocations[t],t)});var y=a.transformFeedbackVaryings;if(y&&(y.attribs&&(y=y.attribs),Array.isArray(y)||(y=Object.keys(y)),e.transformFeedbackVaryings(h,y,a.transformFeedbackMode||e.SEPARATE_ATTRIBS)),e.linkProgram(h),!e.getProgramParameter(h,e.LINK_STATUS)){var v=e.getProgramInfoLog(h);return a.errorCallback("Error in program linking:"+v),e.deleteProgram(h),M(e,u),null}return h}function I(e,t,r,n){var o,i=f(t);if(!i)throw"*** Error: unknown script element"+t;o=i.text;var a=r||F(i.type);if(!a)throw"*** Error: unknown shader type";return C(e,o,a,n)}function U(e,t,r,n,o){for(var i=R(r,n,o),a=[],s=0;s<t.length;++s){var u=C(e,t[s],e[w[s]],i.errorCallback);if(!u)return null;a.push(u)}return B(e,a,i)}function O(e){var t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}function S(e,t){var r=0;function n(t,n){var o,i=e.getUniformLocation(t,n.name),a=n.size>1&&"[0]"===n.name.substr(-3),s=n.type,u=l[s];if(!u)throw"unknown type: 0x"+s.toString(16);if(u.bindPoint){var c=r;r+=n.size,o=a?u.arraySetter(e,s,c,i,n.size):u.setter(e,s,c,i,n.size)}else o=u.arraySetter&&a?u.arraySetter(e,i):u.setter(e,i);return o.location=i,o}for(var o={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),a=0;a<i;++a){var s=e.getActiveUniform(t,a);if(!O(s)){var u=s.name;"[0]"===u.substr(-3)&&(u=u.substr(0,u.length-3));var c=n(t,s);o[u]=c}}return o}function k(e,t){for(var r={},n=e.getProgramParameter(t,e.TRANSFORM_FEEDBACK_VARYINGS),o=0;o<n;++o){var i=e.getTransformFeedbackVarying(t,o);r[i.name]={index:o,type:i.type,size:i.size}}return r}function z(e,t,r){for(var n in t.transformFeedbackInfo&&(t=t.transformFeedbackInfo),r.attribs&&(r=r.attribs),r){var o=t[n];if(o){var i=r[n];i.offset?e.bindBufferRange(e.TRANSFORM_FEEDBACK_BUFFER,o.index,i.buffer,i.offset,i.size):e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,o.index,i.buffer)}}}function D(e,t){for(var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=[],o=[],i=0;i<r;++i){o.push(i),n.push({});var a=e.getActiveUniform(t,i);if(O(a))break;n[i].name=a.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(r){var i=r[0],a=r[1];e.getActiveUniforms(t,o,e[i]).forEach(function(e,t){n[t][a]=e})});for(var s={},u=e.getProgramParameter(t,e.ACTIVE_UNIFORM_BLOCKS),c=0;c<u;++c){var f=e.getActiveUniformBlockName(t,c),l={index:c,usedByVertexShader:e.getActiveUniformBlockParameter(t,c,e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER),usedByFragmentShader:e.getActiveUniformBlockParameter(t,c,e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER),size:e.getActiveUniformBlockParameter(t,c,e.UNIFORM_BLOCK_DATA_SIZE),uniformIndices:e.getActiveUniformBlockParameter(t,c,e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES)};l.used=l.usedByVertexSahder||l.usedByFragmentShader,s[f]=l}return{blockSpecs:s,uniformData:n}}var L=/\[\d+\]\.$/;function N(e,t,r,n){var o=r.blockSpecs,i=r.uniformData,a=o[n];if(!a)return c("no uniform block object named:",n),{name:n,uniforms:{}};var s=new ArrayBuffer(a.size),u=e.createBuffer(),f=a.index;e.bindBuffer(e.UNIFORM_BUFFER,u),e.uniformBlockBinding(t,a.index,f);var d=n+".";L.test(d)&&(d=d.replace(L,"."));var m={};return a.uniformIndices.forEach(function(e){var t=i[e],r=l[t.type],n=r.Type,o=t.size*r.size,a=t.name;a.substr(0,d.length)===d&&(a=a.substr(d.length)),m[a]=new n(s,t.offset,o/n.BYTES_PER_ELEMENT)}),{name:n,array:s,asFloat:new Float32Array(s),buffer:u,uniforms:m}}function j(e,t,r){var n=(t.uniformBlockSpec||t).blockSpecs[r.name];if(n){var o=n.index;return e.bindBufferRange(e.UNIFORM_BUFFER,o,r.buffer,r.offset||0,r.array.byteLength),!0}return!1}function X(e,t){for(var r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<n;++o){var i=e.getActiveAttrib(t,o);if(!O(i)){var a=e.getAttribLocation(t,i.name),s=T[i.type],u=s.setter(e,a,s);u.location=a,r[i.name]=u}}return r}function G(e,t){for(var r in t){var n=e[r];n&&n(t[r])}}function V(e,t){var r={program:t,uniformSetters:S(e,t),attribSetters:X(e,t)};return o.isWebGL2(e)&&(r.uniformBlockSpec=D(e,t),r.transformFeedbackInfo=k(e,t)),r}},function(e,t,r){"use strict";t.__esModule=!0,t.axisRotate=function(e,t,r,n){n=n||new o(16);var i=t[0],a=t[1],s=t[2],u=Math.sqrt(i*i+a*a+s*s),c=(i/=u)*i,f=(a/=u)*a,l=(s/=u)*s,d=Math.cos(r),m=Math.sin(r),p=1-d,h=c+(1-c)*d,y=i*a*p+s*m,v=i*s*p-a*m,b=i*a*p-s*m,E=f+(1-f)*d,_=a*s*p+i*m,x=i*s*p+a*m,g=a*s*p-i*m,T=l+(1-l)*d,A=e[0],P=e[1],C=e[2],R=e[3],w=e[4],F=e[5],M=e[6],B=e[7],I=e[8],U=e[9],O=e[10],S=e[11];n[0]=h*A+y*w+v*I,n[1]=h*P+y*F+v*U,n[2]=h*C+y*M+v*O,n[3]=h*R+y*B+v*S,n[4]=b*A+E*w+_*I,n[5]=b*P+E*F+_*U,n[6]=b*C+E*M+_*O,n[7]=b*R+E*B+_*S,n[8]=x*A+g*w+T*I,n[9]=x*P+g*F+T*U,n[10]=x*C+g*M+T*O,n[11]=x*R+g*B+T*S,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]);return n},t.axisRotation=function(e,t,r){r=r||new o(16);var n=e[0],i=e[1],a=e[2],s=Math.sqrt(n*n+i*i+a*a),u=(n/=s)*n,c=(i/=s)*i,f=(a/=s)*a,l=Math.cos(t),d=Math.sin(t),m=1-l;return r[0]=u+(1-u)*l,r[1]=n*i*m+a*d,r[2]=n*a*m-i*d,r[3]=0,r[4]=n*i*m-a*d,r[5]=c+(1-c)*l,r[6]=i*a*m+n*d,r[7]=0,r[8]=n*a*m+i*d,r[9]=i*a*m-n*d,r[10]=f+(1-f)*l,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},t.copy=u,t.frustum=function(e,t,r,n,i,a,s){s=s||new o(16);var u=t-e,c=n-r,f=i-a;return s[0]=2*i/u,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*i/c,s[6]=0,s[7]=0,s[8]=(e+t)/u,s[9]=(n+r)/c,s[10]=a/f,s[11]=-1,s[12]=0,s[13]=0,s[14]=i*a/f,s[15]=0,s},t.getAxis=function(e,t,r){r=r||n.create();var o=4*t;return r[0]=e[o+0],r[1]=e[o+1],r[2]=e[o+2],r},t.getTranslation=function(e,t){return(t=t||n.create())[0]=e[12],t[1]=e[13],t[2]=e[14],t},t.identity=c,t.inverse=f,t.lookAt=function(e,t,r,u){u=u||new o(16);var c=i,f=a,l=s;return n.normalize(n.subtract(e,t,l),l),n.normalize(n.cross(r,l,c),c),n.normalize(n.cross(l,c,f),f),u[0]=c[0],u[1]=c[1],u[2]=c[2],u[3]=0,u[4]=f[0],u[5]=f[1],u[6]=f[2],u[7]=0,u[8]=l[0],u[9]=l[1],u[10]=l[2],u[11]=0,u[12]=e[0],u[13]=e[1],u[14]=e[2],u[15]=1,u},t.multiply=function(e,t,r){r=r||new o(16);var n=e[0],i=e[1],a=e[2],s=e[3],u=e[4],c=e[5],f=e[6],l=e[7],d=e[8],m=e[9],p=e[10],h=e[11],y=e[12],v=e[13],b=e[14],E=e[15],_=t[0],x=t[1],g=t[2],T=t[3],A=t[4],P=t[5],C=t[6],R=t[7],w=t[8],F=t[9],M=t[10],B=t[11],I=t[12],U=t[13],O=t[14],S=t[15];return r[0]=n*_+u*x+d*g+y*T,r[1]=i*_+c*x+m*g+v*T,r[2]=a*_+f*x+p*g+b*T,r[3]=s*_+l*x+h*g+E*T,r[4]=n*A+u*P+d*C+y*R,r[5]=i*A+c*P+m*C+v*R,r[6]=a*A+f*P+p*C+b*R,r[7]=s*A+l*P+h*C+E*R,r[8]=n*w+u*F+d*M+y*B,r[9]=i*w+c*F+m*M+v*B,r[10]=a*w+f*F+p*M+b*B,r[11]=s*w+l*F+h*M+E*B,r[12]=n*I+u*U+d*O+y*S,r[13]=i*I+c*U+m*O+v*S,r[14]=a*I+f*U+p*O+b*S,r[15]=s*I+l*U+h*O+E*S,r},t.negate=function(e,t){return(t=t||new o(16))[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t},t.ortho=function(e,t,r,n,i,a,s){return(s=s||new o(16))[0]=2/(t-e),s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/(n-r),s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2/(i-a),s[11]=0,s[12]=(t+e)/(e-t),s[13]=(n+r)/(r-n),s[14]=(a+i)/(i-a),s[15]=1,s},t.perspective=function(e,t,r,n,i){i=i||new o(16);var a=Math.tan(.5*Math.PI-.5*e),s=1/(r-n);return i[0]=a/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=(r+n)*s,i[11]=-1,i[12]=0,i[13]=0,i[14]=r*n*s*2,i[15]=0,i},t.rotateX=function(e,t,r){r=r||new o(16);var n=e[4],i=e[5],a=e[6],s=e[7],u=e[8],c=e[9],f=e[10],l=e[11],d=Math.cos(t),m=Math.sin(t);r[4]=d*n+m*u,r[5]=d*i+m*c,r[6]=d*a+m*f,r[7]=d*s+m*l,r[8]=d*u-m*n,r[9]=d*c-m*i,r[10]=d*f-m*a,r[11]=d*l-m*s,e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]);return r},t.rotateY=function(e,t,r){r=r||new o(16);var n=e[0],i=e[1],a=e[2],s=e[3],u=e[8],c=e[9],f=e[10],l=e[11],d=Math.cos(t),m=Math.sin(t);r[0]=d*n-m*u,r[1]=d*i-m*c,r[2]=d*a-m*f,r[3]=d*s-m*l,r[8]=d*u+m*n,r[9]=d*c+m*i,r[10]=d*f+m*a,r[11]=d*l+m*s,e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]);return r},t.rotateZ=function(e,t,r){r=r||new o(16);var n=e[0],i=e[1],a=e[2],s=e[3],u=e[4],c=e[5],f=e[6],l=e[7],d=Math.cos(t),m=Math.sin(t);r[0]=d*n+m*u,r[1]=d*i+m*c,r[2]=d*a+m*f,r[3]=d*s+m*l,r[4]=d*u-m*n,r[5]=d*c-m*i,r[6]=d*f-m*a,r[7]=d*l-m*s,e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]);return r},t.rotationX=function(e,t){t=t||new o(16);var r=Math.cos(e),n=Math.sin(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.rotationY=function(e,t){t=t||new o(16);var r=Math.cos(e),n=Math.sin(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.rotationZ=function(e,t){t=t||new o(16);var r=Math.cos(e),n=Math.sin(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.scale=function(e,t,r){r=r||new o(16);var n=t[0],i=t[1],a=t[2];r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=n*e[3],r[4]=i*e[4],r[5]=i*e[5],r[6]=i*e[6],r[7]=i*e[7],r[8]=a*e[8],r[9]=a*e[9],r[10]=a*e[10],r[11]=a*e[11],e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]);return r},t.scaling=function(e,t){return(t=t||new o(16))[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.setAxis=function(e,t,r,n){n!==e&&(n=u(e,n));var o=4*r;return n[o+0]=t[0],n[o+1]=t[1],n[o+2]=t[2],n},t.setDefaultType=function(e){var t=o;return o=e,t},t.setTranslation=function(e,t,r){r=r||c(),e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11]);return r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r},t.transformDirection=function(e,t,r){r=r||n.create();var o=t[0],i=t[1],a=t[2];return r[0]=o*e[0]+i*e[4]+a*e[8],r[1]=o*e[1]+i*e[5]+a*e[9],r[2]=o*e[2]+i*e[6]+a*e[10],r},t.transformNormal=function(e,t,r){r=r||n.create();var o=f(e),i=t[0],a=t[1],s=t[2];return r[0]=i*o[0]+a*o[1]+s*o[2],r[1]=i*o[4]+a*o[5]+s*o[6],r[2]=i*o[8]+a*o[9]+s*o[10],r},t.transformPoint=function(e,t,r){r=r||n.create();var o=t[0],i=t[1],a=t[2],s=o*e[3]+i*e[7]+a*e[11]+e[15];return r[0]=(o*e[0]+i*e[4]+a*e[8]+e[12])/s,r[1]=(o*e[1]+i*e[5]+a*e[9]+e[13])/s,r[2]=(o*e[2]+i*e[6]+a*e[10]+e[14])/s,r},t.translate=function(e,t,r){r=r||new o(16);var n=t[0],i=t[1],a=t[2],s=e[0],u=e[1],c=e[2],f=e[3],l=e[4],d=e[5],m=e[6],p=e[7],h=e[8],y=e[9],v=e[10],b=e[11],E=e[12],_=e[13],x=e[14],g=e[15];e!==r&&(r[0]=s,r[1]=u,r[2]=c,r[3]=f,r[4]=l,r[5]=d,r[6]=m,r[7]=p,r[8]=h,r[9]=y,r[10]=v,r[11]=b);return r[12]=s*n+l*i+h*a+E,r[13]=u*n+d*i+y*a+_,r[14]=c*n+m*i+v*a+x,r[15]=f*n+p*i+b*a+g,r},t.translation=function(e,t){return(t=t||new o(16))[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},t.transpose=function(e,t){if((t=t||new o(16))===e){var r;return r=e[1],e[1]=e[4],e[4]=r,r=e[2],e[2]=e[8],e[8]=r,r=e[3],e[3]=e[12],e[12]=r,r=e[6],e[6]=e[9],e[9]=r,r=e[7],e[7]=e[13],e[13]=r,r=e[11],e[11]=e[14],e[14]=r,t}var n=e[0],i=e[1],a=e[2],s=e[3],u=e[4],c=e[5],f=e[6],l=e[7],d=e[8],m=e[9],p=e[10],h=e[11],y=e[12],v=e[13],b=e[14],E=e[15];return t[0]=n,t[1]=u,t[2]=d,t[3]=y,t[4]=i,t[5]=c,t[6]=m,t[7]=v,t[8]=a,t[9]=f,t[10]=p,t[11]=b,t[12]=s,t[13]=l,t[14]=h,t[15]=E,t};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}(r(3));var o=Float32Array,i=n.create(),a=n.create(),s=n.create();function u(e,t){return(t=t||new o(16))[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function c(e){return(e=e||new o(16))[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function f(e,t){t=t||new o(16);var r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],u=e[5],c=e[6],f=e[7],l=e[8],d=e[9],m=e[10],p=e[11],h=e[12],y=e[13],v=e[14],b=e[15],E=m*b,_=v*p,x=c*b,g=v*f,T=c*p,A=m*f,P=i*b,C=v*a,R=i*p,w=m*a,F=i*f,M=c*a,B=l*y,I=h*d,U=s*y,O=h*u,S=s*d,k=l*u,z=r*y,D=h*n,L=r*d,N=l*n,j=r*u,X=s*n,G=E*u+g*d+T*y-(_*u+x*d+A*y),V=_*n+P*d+w*y-(E*n+C*d+R*y),Y=x*n+C*u+F*y-(g*n+P*u+M*y),W=A*n+R*u+M*d-(T*n+w*u+F*d),K=1/(r*G+s*V+l*Y+h*W);return t[0]=K*G,t[1]=K*V,t[2]=K*Y,t[3]=K*W,t[4]=K*(_*s+x*l+A*h-(E*s+g*l+T*h)),t[5]=K*(E*r+C*l+R*h-(_*r+P*l+w*h)),t[6]=K*(g*r+P*s+M*h-(x*r+C*s+F*h)),t[7]=K*(T*r+w*s+F*l-(A*r+R*s+M*l)),t[8]=K*(B*f+O*p+S*b-(I*f+U*p+k*b)),t[9]=K*(I*a+z*p+N*b-(B*a+D*p+L*b)),t[10]=K*(U*a+D*f+j*b-(O*a+z*f+X*b)),t[11]=K*(k*a+L*f+X*p-(S*a+N*f+j*p)),t[12]=K*(U*m+k*v+I*c-(S*v+B*c+O*m)),t[13]=K*(L*v+B*i+D*m-(z*m+N*v+I*i)),t[14]=K*(z*c+X*v+O*i-(j*v+U*i+D*c)),t[15]=K*(j*m+S*i+N*c-(L*c+X*m+k*i)),t}},function(e,t,r){"use strict";t.__esModule=!0,t.createAttribsFromArrays=y,t.createBuffersFromArrays=function(e,t){var r={};Object.keys(t).forEach(function(n){r[n]=b(e,t[n],n)}),t.indices?(r.numElements=t.indices.length,r.elementType=n.getGLTypeForTypedArray(h(t.indices),"indices")):r.numElements=function(e){for(var t,r=0;r<v.length&&!((t=v[r])in e);++r);ii===v.length&&(t=Object.keys(e)[0]);var n=e[t],o=f(n).length,i=p(n,t),a=o/i;if(o%i>0)throw"numComponents "+i+" not correct for length "+o;return a}(t);return r},t.createBufferFromArray=b,t.createBufferFromTypedArray=u,t.createBufferInfoFromArrays=function(e,t){var r={attribs:y(e,t)},o=t.indices;if(o){var i=h(o,"indices");r.indices=u(e,i,e.ELEMENT_ARRAY_BUFFER),r.numElements=i.length,r.elementType=n.getGLTypeForTypedArray(i)}else r.numElements=function(e,t){var r,n;for(n=0;n<v.length&&!((r=v[n])in t)&&!((r=a.attribPrefix+r)in t);++n);n===v.length&&(r=Object.keys(t)[0]);var o=t[r];e.bindBuffer(e.ARRAY_BUFFER,o.buffer);var i=e.getBufferParameter(e.ARRAY_BUFFER,e.BUFFER_SIZE);e.bindBuffer(e.ARRAY_BUFFER,null);var s=function(e,t){return t===e.BYTE?1:t===e.UNSIGNED_BYTE?1:t===e.SHORT?2:t===e.UNSIGNED_SHORT?2:t===e.INT?4:t===e.UNSIGNED_INT?4:t===e.FLOAT?4:0}(e,o.type),u=i/s,c=o.numComponents||o.size,f=u/c;if(f%1!=0)throw"numComponents "+c+" not correct for length "+length;return f}(e,r.attribs);return r},t.setAttribInfoBufferFromArray=function(e,t,r,n){r=h(r),void 0!==n?(e.bindBuffer(e.ARRAY_BUFFER,t.buffer),e.bufferSubData(e.ARRAY_BUFFER,n,r)):s(e,e.ARRAY_BUFFER,t.buffer,r,t.drawType)},t.setAttributePrefix=function(e){a.attribPrefix=e},t.setAttributeDefaults_=function(e){o.copyExistingProperties(e,a)},t.getNumComponents_=p,t.getArray_=f;var n=i(r(1)),o=i(r(0));function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var a={attribPrefix:""};function s(e,t,r,n,o){e.bindBuffer(t,r),e.bufferData(t,n,o||e.STATIC_DRAW)}function u(e,t,r,n){if(o.isBuffer(e,t))return t;r=r||e.ARRAY_BUFFER;var i=e.createBuffer();return s(e,r,i,t,n),i}function c(e){return"indices"===e}function f(e){return e.length?e:e.data}var l=/coord|texture/i,d=/color|colour/i;function m(e,t){var r;if(t%(r=l.test(e)?2:d.test(e)?4:3)>0)throw"Can not guess numComponents for attribute '"+e+"'. Tried "+r+" but "+t+" values is not evenly divisible by "+r+". You should specify it.";return r}function p(e,t){return e.numComponents||e.size||m(t,f(e).length)}function h(e,t){if(n.isArrayBuffer(e))return e;if(n.isArrayBuffer(e.data))return e.data;Array.isArray(e)&&(e={data:e});var r=e.type;return r||(r=c(t)?Uint16Array:Float32Array),new r(e.data)}function y(e,t){var r={};return Object.keys(t).forEach(function(o){if(!c(o)){var i,s,f,l,d,y=t[o],v=y.attrib||y.name||y.attribName||a.attribPrefix+o;if("number"==typeof y||"number"==typeof y.data){d=y.data||y;var b=y.type||Float32Array,E=d*b.BYTES_PER_ELEMENT;s=n.getGLTypeForTypedArrayType(b),f=void 0!==y.normalize?y.normalize:(x=b)===Int8Array||x===Uint8Array,l=y.numComponents||y.size||m(o,d),i=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,E,y.drawType||e.STATIC_DRAW)}else{var _=h(y,o);i=u(e,_,void 0,y.drawType),s=n.getGLTypeForTypedArray(_),f=void 0!==y.normalize?y.normalize:function(e){return e instanceof Int8Array||e instanceof Uint8Array}(_),l=p(y,o),d=_.length}r[v]={buffer:i,numComponents:l,type:s,normalize:f,stride:y.stride||0,offset:y.offset||0,divisor:void 0===y.divisor?void 0:y.divisor,drawType:y.drawType}}var x}),e.bindBuffer(e.ARRAY_BUFFER,null),r}var v=["position","positions","a_position"];function b(e,t,r){var n="indices"===r?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;return u(e,h(t,r),n)}},function(e,t,r){"use strict";t.__esModule=!0,t.setTextureDefaults_=function(e){a.copyExistingProperties(e,c),e.textureColor&&T(e.textureColor)},t.createSampler=I,t.createSamplers=function(e,t){var r={};return Object.keys(t).forEach(function(n){r[n]=I(e,t[n])}),r},t.setSamplerParameters=B,t.createTexture=K,t.setEmptyTexture=W,t.setTextureFromArray=Y,t.loadTextureFromUrl=X,t.setTextureFromElement=z,t.setTextureFilteringForSize=U,t.setTextureParameters=M,t.setDefaultTextureColor=T,t.createTextures=function(e,t,r){r=r||D;var n=0,o=[],i={},a={};function s(){0===n&&setTimeout(function(){r(o.length?o:void 0,i,a)},0)}return Object.keys(t).forEach(function(r){var u,c,f=t[r];("string"==typeof(c=f.src)||Array.isArray(c)&&"string"==typeof c[0])&&(u=function(e,t,i){a[r]=i,--n,e&&o.push(e),s()},++n),i[r]=K(e,f,u)}),s(),i},t.resizeTexture=function(e,t,r,n,o){n=n||r.width,o=o||r.height;var i=r.target||e.TEXTURE_2D;e.bindTexture(i,t);var a,s=r.level||0,u=r.internalFormat||r.format||e.RGBA,c=E(u),l=r.format||c.format,d=r.src;a=d&&(f(d)||Array.isArray(d)&&"number"==typeof d[0])?r.type||x(e,d,c.type):r.type||c.type;if(i===e.TEXTURE_CUBE_MAP)for(var m=0;m<6;++m)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,s,u,n,o,0,l,a,null);else e.texImage2D(i,s,u,n,o,0,l,a,null)},t.getNumComponentsForFormat=function(e){var t=p[e];if(!t)throw"unknown format: "+e;return t.numColorComponents},t.getBytesPerElementForInternalFormat=b;var n,o=u(r(4)),i=u(r(1)),a=u(r(0)),s=(n=r(2))&&n.__esModule?n:{default:n};function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var c={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},f=i.isArrayBuffer,l=s.default.document&&s.default.document.createElement?s.default.document.createElement("canvas").getContext("2d"):null,d=6407,m=33319,p={},h=p;h[6406]={numColorComponents:1},h[6409]={numColorComponents:1},h[6410]={numColorComponents:2},h[d]={numColorComponents:3},h[6408]={numColorComponents:4},h[6403]={numColorComponents:1},h[36244]={numColorComponents:1},h[m]={numColorComponents:2},h[33320]={numColorComponents:2},h[d]={numColorComponents:3},h[36248]={numColorComponents:3},h[6408]={numColorComponents:4},h[36249]={numColorComponents:4},h[6402]={numColorComponents:1},h[34041]={numColorComponents:2};var y={},v=y;function b(e,t){var r=y[e];if(!r)throw"unknown internal format";var n=r.bytesPerElementMap[t];if(void 0===n)throw"unknown internal format";return n}function E(e){var t=y[e];if(!t)throw"unknown internal format";return{format:t.textureFormat,type:Array.isArray(t.type)?t.type[0]:t.type}}function _(e){return 0==(e&e-1)}function x(e,t,r){return f(t)?i.getGLTypeForTypedArray(t):r||e.UNSIGNED_BYTE}function g(e,t,r,n,o){if(o%1!=0)throw"can't guess dimensions";if(r||n){if(n){if(!r&&(r=o/n)%1)throw"can't guess dimensions"}else if((n=o/r)%1)throw"can't guess dimensions"}else{var i=Math.sqrt(o/(t===e.TEXTURE_CUBE_MAP?6:1));i%1==0?(r=i,n=i):(r=o,n=1)}return{width:r,height:n}}function T(e){c.textureColor=new Uint8Array([255*e[0],255*e[1],255*e[2],255*e[3]])}v[6406]={textureFormat:6406,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[5121,5131,36193,5126]},v[6409]={textureFormat:6409,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[5121,5131,36193,5126]},v[6410]={textureFormat:6410,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[5121,5131,36193,5126]},v[d]={textureFormat:d,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[5121,5131,36193,5126,33635]},v[6408]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[5121,5131,36193,5126,32819,32820]},v[33321]={textureFormat:6403,colorRenderable:!0,textureFilterable:!0,bytesPerElement:1,type:5121},v[36756]={textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:1,type:5120},v[33325]={textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[5126,5131]},v[33326]={textureFormat:6403,colorRenderable:!1,textureFilterable:!1,bytesPerElement:4,type:5126},v[33330]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:1,type:5121},v[33329]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:1,type:5120},v[33332]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5123},v[33331]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5122},v[33334]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5125},v[33333]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5124},v[33323]={textureFormat:m,colorRenderable:!0,textureFilterable:!0,bytesPerElement:2,type:5121},v[36757]={textureFormat:m,colorRenderable:!1,textureFilterable:!0,bytesPerElement:2,type:5120},v[33327]={textureFormat:m,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[5126,5131]},v[33328]={textureFormat:m,colorRenderable:!1,textureFilterable:!1,bytesPerElement:8,type:5126},v[33336]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5121},v[33335]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5120},v[33338]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5123},v[33337]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5122},v[33340]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5125},v[33339]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5124},v[32849]={textureFormat:d,colorRenderable:!0,textureFilterable:!0,bytesPerElement:3,type:5121},v[35905]={textureFormat:d,colorRenderable:!1,textureFilterable:!0,bytesPerElement:3,type:5121},v[36194]={textureFormat:d,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[5121,33635]},v[36758]={textureFormat:d,colorRenderable:!1,textureFilterable:!0,bytesPerElement:3,type:5120},v[35898]={textureFormat:d,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[5126,5131,35899]},v[35901]={textureFormat:d,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[5126,5131,35902]},v[34843]={textureFormat:d,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[5126,5131]},v[34837]={textureFormat:d,colorRenderable:!1,textureFilterable:!1,bytesPerElement:12,type:5126},v[36221]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:3,type:5121},v[36239]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:3,type:5120},v[36215]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:6,type:5123},v[36233]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:6,type:5122},v[36209]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:12,type:5125},v[36227]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:12,type:5124},v[32856]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:4,type:5121},v[35907]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:4,type:5121},v[36759]={textureFormat:6408,colorRenderable:!1,textureFilterable:!0,bytesPerElement:4,type:5120},v[32855]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[5121,32820,33640]},v[32854]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[5121,32819]},v[32857]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:4,type:33640},v[34842]={textureFormat:6408,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[5126,5131]},v[34836]={textureFormat:6408,colorRenderable:!1,textureFilterable:!1,bytesPerElement:16,type:5126},v[36220]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5121},v[36238]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5120},v[36975]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:33640},v[36214]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5123},v[36232]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5122},v[36226]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:16,type:5124},v[36208]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:16,type:5125},v[33189]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[5123,5125]},v[33190]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5125},v[36012]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5126},v[35056]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:34042},v[36013]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:36269},Object.keys(v).forEach(function(e){var t=v[e];if(t.bytesPerElementMap={},Array.isArray(t.bytesPerElement))t.bytesPerElement.forEach(function(e,r){var n=t.type[r];t.bytesPerElementMap[n]=e});else{var r=t.type;t.bytesPerElementMap[r]=t.bytesPerElement}});var A={};function P(e,t){void 0!==t.colorspaceConversion&&(A.colorspaceConversion=e.getParameter(e.UNPACK_COLORSPACE_CONVERSION_WEBGL),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.colorspaceConversion)),void 0!==t.premultiplyAlpha&&(A.premultiplyAlpha=e.getParameter(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha)),void 0!==t.flipY&&(A.flipY=e.getParameter(e.UNPACK_FLIP_Y_WEBGL),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY))}function C(e,t){void 0!==t.colorspaceConversion&&e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,A.colorspaceConversion),void 0!==t.premultiplyAlpha&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A.premultiplyAlpha),void 0!==t.flipY&&e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,A.flipY)}function R(e){A.unpackAlignment=e.getParameter(e.UNPACK_ALIGNMENT),o.isWebGL2(e)&&(A.unpackRowLength=e.getParameter(e.UNPACK_ROW_LENGTH),A.unpackImageHeight=e.getParameter(e.UNPACK_IMAGE_HEIGHT),A.unpackSkipPixels=e.getParameter(e.UNPACK_SKIP_PIXELS),A.unpackSkipRows=e.getParameter(e.UNPACK_SKIP_ROWS),A.unpackSkipImages=e.getParameter(e.UNPACK_SKIP_IMAGES))}function w(e){e.pixelStorei(e.UNPACK_ALIGNMENT,A.unpackAlignment),o.isWebGL2(e)&&(e.pixelStorei(e.UNPACK_ROW_LENGTH,A.unpackRowLength),e.pixelStorei(e.UNPACK_IMAGE_HEIGHT,A.unpackImageHeight),e.pixelStorei(e.UNPACK_SKIP_PIXELS,A.unpackSkipPixels),e.pixelStorei(e.UNPACK_SKIP_ROWS,A.unpackSkipRows),e.pixelStorei(e.UNPACK_SKIP_IMAGES,A.unpackSkipImages))}function F(e,t,r,n){n.minMag&&(r.call(e,t,e.TEXTURE_MIN_FILTER,n.minMag),r.call(e,t,e.TEXTURE_MAG_FILTER,n.minMag)),n.min&&r.call(e,t,e.TEXTURE_MIN_FILTER,n.min),n.mag&&r.call(e,t,e.TEXTURE_MAG_FILTER,n.mag),n.wrap&&(r.call(e,t,e.TEXTURE_WRAP_S,n.wrap),r.call(e,t,e.TEXTURE_WRAP_T,n.wrap),(t===e.TEXTURE_3D||a.isSampler(e,t))&&r.call(e,t,e.TEXTURE_WRAP_R,n.wrap)),n.wrapR&&r.call(e,t,e.TEXTURE_WRAP_R,n.wrapR),n.wrapS&&r.call(e,t,e.TEXTURE_WRAP_S,n.wrapS),n.wrapT&&r.call(e,t,e.TEXTURE_WRAP_T,n.wrapT),n.minLod&&r.call(e,t,e.TEXTURE_MIN_LOD,n.minLod),n.maxLod&&r.call(e,t,e.TEXTURE_MAX_LOD,n.maxLod),n.baseLevel&&r.call(e,t,e.TEXTURE_BASE_LEVEL,n.baseLevel),n.maxLevel&&r.call(e,t,e.TEXTURE_MAX_LEVEL,n.maxLevel)}function M(e,t,r){var n=r.target||e.TEXTURE_2D;e.bindTexture(n,t),F(e,n,e.texParameteri,r)}function B(e,t,r){F(e,t,e.samplerParameteri,r)}function I(e,t){var r=e.createSampler();return B(e,r,t),r}function U(e,t,r,n,i,a,s){r=r||c.textureOptions,a=a||e.RGBA,s=s||e.UNSIGNED_BYTE;var u=r.target||e.TEXTURE_2D;if(n=n||r.width,i=i||r.height,e.bindTexture(u,t),function(e,t,r,n){if(!o.isWebGL2(e))return _(t)&&_(r);var i=y[n];if(!i)throw"unknown internal format";return i.colorRenderable&&i.textureFilterable}(e,n,i,a))e.generateMipmap(u);else{var f=function(e){var t=y[e];if(!t)throw"unknown internal format";return t.textureFilterable}(a)?e.LINEAR:e.NEAREST;e.texParameteri(u,e.TEXTURE_MIN_FILTER,f),e.texParameteri(u,e.TEXTURE_MAG_FILTER,f),e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}}function O(e){return!0===e.auto||void 0===e.auto&&void 0===e.level}function S(e,t){return(t=t||{}).cubeFaceOrder||[e.TEXTURE_CUBE_MAP_POSITIVE_X,e.TEXTURE_CUBE_MAP_NEGATIVE_X,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_Z,e.TEXTURE_CUBE_MAP_NEGATIVE_Z]}function k(e,t){var r=S(e,t).map(function(e,t){return{face:e,ndx:t}});return r.sort(function(e,t){return e.face-t.face}),r}function z(e,t,r,n){var o=(n=n||c.textureOptions).target||e.TEXTURE_2D,i=n.level||0,a=r.width,u=r.height,f=n.internalFormat||n.format||e.RGBA,d=E(f),m=n.format||d.format,p=n.type||d.type;if(P(e,n),e.bindTexture(o,t),o===e.TEXTURE_CUBE_MAP){var h,y,v=r.width,b=r.height;if(v/6===b)h=b,y=[0,0,1,0,2,0,3,0,4,0,5,0];else if(b/6===v)h=v,y=[0,0,0,1,0,2,0,3,0,4,0,5];else if(v/3==b/2)h=v/3,y=[0,0,1,0,2,0,0,1,1,1,2,1];else{if(v/2!=b/3)throw"can't figure out cube map from element: "+(r.src?r.src:r.nodeName);h=v/2,y=[0,0,1,0,0,1,1,1,0,2,1,2]}l?(l.canvas.width=h,l.canvas.height=h,a=h,u=h,k(e,n).forEach(function(t){var n=y[2*t.ndx+0]*h,o=y[2*t.ndx+1]*h;l.drawImage(r,n,o,h,h,0,0,h,h),e.texImage2D(t.face,i,f,m,p,l.canvas)}),l.canvas.width=1,l.canvas.height=1):s.default.createImageBitmap&&(a=h,u=h,k(e,n).forEach(function(c){var l=y[2*c.ndx+0]*h,d=y[2*c.ndx+1]*h;e.texImage2D(c.face,i,f,h,h,0,m,p,null),s.default.createImageBitmap(r,l,d,h,h,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(r){P(e,n),e.bindTexture(o,t),e.texImage2D(c.face,i,f,m,p,r),C(e,n),O(n)&&U(e,t,n,a,u,f,p)})}))}else if(o===e.TEXTURE_3D||o===e.TEXTURE_2D_ARRAY){var _=Math.min(r.width,r.height),x=Math.max(r.width,r.height),g=x/_;if(g%1!=0)throw"can not compute 3D dimensions of element";var T=r.width===x?1:0,A=r.height===x?1:0;R(e),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.pixelStorei(e.UNPACK_ROW_LENGTH,r.width),e.pixelStorei(e.UNPACK_IMAGE_HEIGHT,0),e.pixelStorei(e.UNPACK_SKIP_IMAGES,0),e.texImage3D(o,i,f,_,_,_,0,m,p,null);for(var F=0;F<g;++F){var B=F*_*T,I=F*_*A;e.pixelStorei(e.UNPACK_SKIP_PIXELS,B),e.pixelStorei(e.UNPACK_SKIP_ROWS,I),e.texSubImage3D(o,i,0,0,F,_,_,1,m,p,r)}w(e)}else e.texImage2D(o,i,f,m,p,r);C(e,n),O(n)&&U(e,t,n,a,u,f,p),M(e,t,n)}function D(){}function L(e){return s.default.ImageBitmap&&e instanceof s.default.ImageBitmap||s.default.ImageData&&e instanceof s.default.ImageData||s.default.HTMLElement&&e instanceof s.default.HTMLElement}function N(e,t,r){return L(e)?(setTimeout(function(){r(null,e)}),e):function(e,t,r){var n;if(r=r||D,s.default.Image){n=new s.default.Image,void 0!==(t=void 0!==t?t:c.crossOrigin)&&(n.crossOrigin=t);var o=function(){n.removeEventListener("error",i),n.removeEventListener("load",u),n=null},i=function(){var t="couldn't load image: "+e;a.error(t),r(t,n),o()},u=function(){r(null,n),o()};return n.addEventListener("error",i),n.addEventListener("load",u),n.src=e,n}if(s.default.ImageBitmap){var f,l,d=function(){r(f,l)},m={};t&&(m.mode="cors"),fetch(e,m).then(function(e){if(!e.ok)throw e;return e.blob()}).then(function(e){return s.default.createImageBitmap(e,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(e){l=e,setTimeout(d)}).catch(function(e){f=e,setTimeout(d)}),n=null}return n}(e,t,r)}function j(e,t,r){var n=(r=r||c.textureOptions).target||e.TEXTURE_2D;if(e.bindTexture(n,t),!1!==r.color){var o=function(e){return e=e||c.textureColor,f(e)?e:new Uint8Array([255*e[0],255*e[1],255*e[2],255*e[3]])}(r.color);if(n===e.TEXTURE_CUBE_MAP)for(var i=0;i<6;++i)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,o);else n===e.TEXTURE_3D||n===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,1,0,e.RGBA,e.UNSIGNED_BYTE,o):e.texImage2D(n,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,o)}}function X(e,t,r,n){return n=n||D,r=r||c.textureOptions,j(e,t,r),N((r=Object.assign({},r)).src,r.crossOrigin,function(o,i){o?n(o,t,i):(z(e,t,i,r),n(null,t,i))})}function G(e,t,r,n){n=n||D;var o=r.src;if(6!==o.length)throw"there must be 6 urls for a cubemap";var i=r.level||0,a=r.internalFormat||r.format||e.RGBA,s=E(a),u=r.format||s.format,c=r.type||e.UNSIGNED_BYTE,f=r.target||e.TEXTURE_2D;if(f!==e.TEXTURE_CUBE_MAP)throw"target must be TEXTURE_CUBE_MAP";j(e,t,r),r=Object.assign({},r);var l,d=6,m=[],p=S(e,r);l=o.map(function(o,s){return N(o,r.crossOrigin,(h=p[s],function(o,s){--d,o?m.push(o):s.width!==s.height?m.push("cubemap face img is not a square: "+s.src):(P(e,r),e.bindTexture(f,t),5===d?S(e).forEach(function(t){e.texImage2D(t,i,a,u,c,s)}):e.texImage2D(h,i,a,u,c,s),C(e,r),O(r)&&e.generateMipmap(f)),0===d&&n(m.length?m:void 0,t,l)}));var h})}function V(e,t,r,n){n=n||D;var o=r.src,i=r.internalFormat||r.format||e.RGBA,a=E(i),s=r.format||a.format,u=r.type||e.UNSIGNED_BYTE,c=r.target||e.TEXTURE_2D_ARRAY;if(c!==e.TEXTURE_3D&&c!==e.TEXTURE_2D_ARRAY)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";j(e,t,r),r=Object.assign({},r);var f,d=o.length,m=[],p=r.level||0,h=r.width,y=r.height,v=o.length,b=!0;f=o.map(function(o,a){return N(o,r.crossOrigin,(E=a,function(o,a){if(--d,o)m.push(o);else{if(P(e,r),e.bindTexture(c,t),b){b=!1,h=r.width||a.width,y=r.height||a.height,e.texImage3D(c,p,i,h,y,v,0,s,u,null);for(var _=0;_<v;++_)e.texSubImage3D(c,p,0,0,_,h,y,1,s,u,a)}else{var x=a;a.width===h&&a.height===y||(x=l.canvas,l.canvas.width=h,l.canvas.height=y,l.drawImage(a,0,0,h,y)),e.texSubImage3D(c,p,0,0,E,h,y,1,s,u,x),x===l.canvas&&(l.canvas.width=0,l.canvas.height=0)}C(e,r),O(r)&&e.generateMipmap(c)}0===d&&n(m.length?m:void 0,t,f)}));var E})}function Y(e,t,r,n){var a=(n=n||c.textureOptions).target||e.TEXTURE_2D;e.bindTexture(a,t);var s=n.width,u=n.height,l=n.depth,d=n.level||0,m=n.internalFormat||n.format||e.RGBA,p=E(m),h=n.format||p.format,y=n.type||x(e,r,p.type);if(f(r))r instanceof Uint8ClampedArray&&(r=new Uint8Array(r.buffer));else{var v=i.getTypedArrayTypeForGLType(y);r=new v(r)}var _,T=b(m,y),A=r.byteLength/T;if(A%1)throw"length wrong size for format: "+o.glEnumToString(e,h);if(a===e.TEXTURE_3D)if(s||u||l)!s||u&&l?!u||s&&l?(_=g(e,a,s,u,A/l),s=_.width,u=_.height):(_=g(e,a,s,l,A/u),s=_.width,l=_.height):(_=g(e,a,u,l,A/s),u=_.width,l=_.height);else{var F=Math.cbrt(A);if(F%1!=0)throw"can't guess cube size of array of numElements: "+A;s=F,u=F,l=F}else _=g(e,a,s,u,A),s=_.width,u=_.height;if(R(e),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment||1),P(e,n),a===e.TEXTURE_CUBE_MAP){var M=A/6*(T/r.BYTES_PER_ELEMENT);k(e,n).forEach(function(t){var n=M*t.ndx,o=r.subarray(n,n+M);e.texImage2D(t.face,d,m,s,u,0,h,y,o)})}else a===e.TEXTURE_3D?e.texImage3D(a,d,m,s,u,l,0,h,y,r):e.texImage2D(a,d,m,s,u,0,h,y,r);return C(e,n),w(e),{width:s,height:u,depth:l,type:y}}function W(e,t,r){var n=r.target||e.TEXTURE_2D;e.bindTexture(n,t);var o=r.level||0,i=r.internalFormat||r.format||e.RGBA,a=E(i),s=r.format||a.format,u=r.type||a.type;if(P(e,r),n===e.TEXTURE_CUBE_MAP)for(var c=0;c<6;++c)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+c,o,i,r.width,r.height,0,s,u,null);else n===e.TEXTURE_3D?e.texImage3D(n,o,i,r.width,r.height,r.depth,0,s,u,null):e.texImage2D(n,o,i,r.width,r.height,0,s,u,null);C(e,r)}function K(e,t,r){r=r||D,t=t||c.textureOptions;var n=e.createTexture(),o=t.target||e.TEXTURE_2D,i=t.width||1,a=t.height||1,s=t.internalFormat||e.RGBA,u=E(s),l=t.type||u.type;e.bindTexture(o,n),o===e.TEXTURE_CUBE_MAP&&(e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE));var d=t.src;if(d)if("function"==typeof d&&(d=d(e,t)),"string"==typeof d)X(e,n,t,r);else if(f(d)||Array.isArray(d)&&("number"==typeof d[0]||Array.isArray(d[0])||f(d[0]))){var m=Y(e,n,d,t);i=m.width,a=m.height,l=m.type}else if(Array.isArray(d)&&("string"==typeof d[0]||L(d[0])))o===e.TEXTURE_CUBE_MAP?G(e,n,t,r):V(e,n,t,r);else{if(!L(d))throw"unsupported src type";z(e,n,d,t),i=d.width,a=d.height}else W(e,n,t);return O(t)&&U(e,n,t,i,a,s,l),M(e,n,t),n}},function(e,t,r){"use strict";t.__esModule=!0;var n={m4:!0,v3:!0,primitives:!0};t.primitives=t.v3=t.m4=void 0;var o=u(r(6));t.m4=o;var i=u(r(3));t.v3=i;var a=u(r(10));t.primitives=a;var s=r(11);function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=s[e]))})},function(e,t,r){"use strict";t.__esModule=!0,t.create3DFVertices=R,t.createAugmentedTypedArray=d,t.createCubeVertices=A,t.createPlaneVertices=x,t.createSphereVertices=g,t.createTruncatedConeVertices=P,t.createXYQuadVertices=_,t.createCresentVertices=w,t.createCylinderVertices=F,t.createTorusVertices=M,t.createDiscVertices=B,t.deindexVertices=function(e){var t=e.indices,r={},n=t.length;return Object.keys(e).filter(m).forEach(function(o){for(var i=e[o],a=i.numComponents,s=d(a,n,i.constructor),u=0;u<n;++u)for(var c=t[u],f=c*a,l=0;l<a;++l)s.push(i[f+l]);r[o]=s}),r},t.flattenNormals=function(e){if(e.indices)throw"can't flatten normals of indexed vertices. deindex them first";for(var t=e.normal,r=t.length,n=0;n<r;n+=9){var o=t[n+0],i=t[n+1],a=t[n+2],s=t[n+3],u=t[n+4],c=t[n+5],f=t[n+6],l=t[n+7],d=t[n+8],m=o+s+f,p=i+u+l,h=a+c+d,y=Math.sqrt(m*m+p*p+h*h);m/=y,p/=y,h/=y,t[n+0]=m,t[n+1]=p,t[n+2]=h,t[n+3]=m,t[n+4]=p,t[n+5]=h,t[n+6]=m,t[n+7]=p,t[n+8]=h}return e},t.makeRandomVertexColors=function(e,t){t=t||{};var r=e.position.numElements,n=d(4,r,Uint8Array),o=t.rand||function(e,t){return t<3?(r=256,Math.random()*r|0):255;var r};if(e.color=n,e.indices)for(var i=0;i<r;++i)n.push(o(i,0),o(i,1),o(i,2),o(i,3));else for(var a=t.vertsPerColor||3,s=r/a,u=0;u<s;++u)for(var c=[o(u,0),o(u,1),o(u,2),o(u,3)],f=0;f<a;++f)n.push(c);return e},t.reorientDirections=y,t.reorientNormals=v,t.reorientPositions=b,t.reorientVertices=E,t.concatVertices=function(e){for(var t,r={},n=function(n){var o=e[n];Object.keys(o).forEach(function(e){r[e]||(r[e]=[]),t||"indices"===e||(t=e);var n=o[e],i=f(n,e),a=c(n),s=a.length/i;r[e].push(s)})},o=0;o<e.length;++o)n(o);var i=r[t],a={};return Object.keys(r).forEach(function(t){var r=function(t){for(var r,n=0,o=0;o<e.length;++o){var i=e[o],a=i[t],s=c(a);n+=s.length,r&&!a.data||(r=a)}return{length:n,spec:r}}(t),n=k(r.spec,r.length);!function(t,r,n){for(var o=0,i=0,a=0;a<e.length;++a){var s=e[a],u=s[t],f=c(u);"indices"===t?(S(f,n,i,o),o+=r[a]):S(f,n,i),i+=f.length}}(t,i,c(n)),a[t]=n}),a},t.duplicateVertices=function(e){var t={};return Object.keys(e).forEach(function(r){var n=e[r],o=c(n),i=k(n,o.length);S(o,c(i),0),t[r]=i}),t},t.createDiscBuffers=t.createDiscBufferInfo=t.createTorusBuffers=t.createTorusBufferInfo=t.createCylinderBuffers=t.createCylinderBufferInfo=t.createCresentBuffers=t.createCresentBufferInfo=t.createXYQuadBuffers=t.createXYQuadBufferInfo=t.createTruncatedConeBuffers=t.createTruncatedConeBufferInfo=t.createSphereBuffers=t.createSphereBufferInfo=t.createPlaneBuffers=t.createPlaneBufferInfo=t.createCubeBuffers=t.createCubeBufferInfo=t.create3DFBuffers=t.create3DFBufferInfo=void 0;var n=u(r(7)),o=u(r(0)),i=u(r(1)),a=u(r(6)),s=u(r(3));function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var c=n.getArray_,f=n.getNumComponents_;function l(e,t){var r=0;return e.push=function(){for(var t=0;t<arguments.length;++t){var n=arguments[t];if(n instanceof Array||i.isArrayBuffer(n))for(var o=0;o<n.length;++o)e[r++]=n[o];else e[r++]=n}},e.reset=function(e){r=e||0},e.numComponents=t,Object.defineProperty(e,"numElements",{get:function(){return this.length/this.numComponents|0}}),e}function d(e,t,r){return l(new(r||Float32Array)(e*t),e)}function m(e){return"indices"!==e}function p(e,t,r){for(var n=e.length,o=new Float32Array(3),i=0;i<n;i+=3)r(t,[e[i],e[i+1],e[i+2]],o),e[i]=o[0],e[i+1]=o[1],e[i+2]=o[2]}function h(e,t,r){r=r||s.create();var n=t[0],o=t[1],i=t[2];return r[0]=n*e[0]+o*e[1]+i*e[2],r[1]=n*e[4]+o*e[5]+i*e[6],r[2]=n*e[8]+o*e[9]+i*e[10],r}function y(e,t){return p(e,t,a.transformDirection),e}function v(e,t){return p(e,a.inverse(t),h),e}function b(e,t){return p(e,t,a.transformPoint),e}function E(e,t){return Object.keys(e).forEach(function(r){var n=e[r];r.indexOf("pos")>=0?b(n,t):r.indexOf("tan")>=0||r.indexOf("binorm")>=0?y(n,t):r.indexOf("norm")>=0&&v(n,t)}),e}function _(e,t,r){return e=e||2,{position:{numComponents:2,data:[(t=t||0)+-1*(e*=.5),(r=r||0)+-1*e,t+1*e,r+-1*e,t+-1*e,r+1*e,t+1*e,r+1*e]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function x(e,t,r,n,o){e=e||1,t=t||1,r=r||1,n=n||1,o=o||a.identity();for(var i=(r+1)*(n+1),s=d(3,i),u=d(3,i),c=d(2,i),f=0;f<=n;f++)for(var l=0;l<=r;l++){var m=l/r,p=f/n;s.push(e*m-.5*e,0,t*p-.5*t),u.push(0,1,0),c.push(m,p)}for(var h=r+1,y=d(3,r*n*2,Uint16Array),v=0;v<n;v++)for(var b=0;b<r;b++)y.push((v+0)*h+b,(v+1)*h+b,(v+0)*h+b+1),y.push((v+1)*h+b,(v+1)*h+b+1,(v+0)*h+b+1);return E({position:s,normal:u,texcoord:c,indices:y},o)}function g(e,t,r,n,o,i,a){if(t<=0||r<=0)throw Error("subdivisionAxis and subdivisionHeight must be > 0");n=n||0,o=o||Math.PI,i=i||0;for(var s=o-n,u=(a=a||2*Math.PI)-i,c=(t+1)*(r+1),f=d(3,c),l=d(3,c),m=d(2,c),p=0;p<=r;p++)for(var h=0;h<=t;h++){var y=h/t,v=p/r,b=u*y,E=s*v,_=Math.sin(b),x=Math.cos(b),g=Math.sin(E),T=x*g,A=Math.cos(E),P=_*g;f.push(e*T,e*A,e*P),l.push(T,A,P),m.push(1-y,v)}for(var C=t+1,R=d(3,t*r*2,Uint16Array),w=0;w<t;w++)for(var F=0;F<r;F++)R.push((F+0)*C+w,(F+0)*C+w+1,(F+1)*C+w),R.push((F+1)*C+w,(F+0)*C+w+1,(F+1)*C+w+1);return{position:f,normal:l,texcoord:m,indices:R}}var T=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function A(e){for(var t=(e=e||1)/2,r=[[-t,-t,-t],[+t,-t,-t],[-t,+t,-t],[+t,+t,-t],[-t,-t,+t],[+t,-t,+t],[-t,+t,+t],[+t,+t,+t]],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],o=[[1,0],[0,0],[0,1],[1,1]],i=d(3,24),a=d(3,24),s=d(2,24),u=d(3,12,Uint16Array),c=0;c<6;++c){for(var f=T[c],l=0;l<4;++l){var m=r[f[l]],p=n[c],h=o[l];i.push(m),a.push(p),s.push(h)}var y=4*c;u.push(y+0,y+1,y+2),u.push(y+0,y+2,y+3)}return{position:i,normal:a,texcoord:s,indices:u}}function P(e,t,r,n,o,i,a){if(n<3)throw Error("radialSubdivisions must be 3 or greater");if(o<1)throw Error("verticalSubdivisions must be 1 or greater");for(var s=void 0===i||i,u=void 0===a||a,c=(s?2:0)+(u?2:0),f=(n+1)*(o+1+c),l=d(3,f),m=d(3,f),p=d(2,f),h=d(3,n*(o+c)*2,Uint16Array),y=n+1,v=Math.atan2(e-t,r),b=Math.cos(v),E=Math.sin(v),_=o+(u?2:0),x=s?-2:0;x<=_;++x){var g=x/o,T=r*g,A=void 0;x<0?(T=0,g=1,A=e):x>o?(T=r,g=1,A=t):A=e+x/o*(t-e),-2!==x&&x!==o+2||(A=0,g=0),T-=r/2;for(var P=0;P<y;++P){var C=Math.sin(P*Math.PI*2/n),R=Math.cos(P*Math.PI*2/n);l.push(C*A,T,R*A),m.push(x<0||x>o?0:C*b,x<0?-1:x>o?1:E,x<0||x>o?0:R*b),p.push(P/n,1-g)}}for(var w=0;w<o+c;++w)for(var F=0;F<n;++F)h.push(y*(w+0)+0+F,y*(w+0)+1+F,y*(w+1)+1+F),h.push(y*(w+0)+0+F,y*(w+1)+1+F,y*(w+1)+0+F);return{position:l,normal:m,texcoord:p,indices:h}}function C(e,t){t=t||[];for(var r=[],n=0;n<e.length;n+=4){var o=e[n],i=e.slice(n+1,n+4);i.push.apply(i,t);for(var a=0;a<o;++a)r.push.apply(r,i)}return r}function R(){var e=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],t=C([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),r=C([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),n=e.length/3,o={position:d(3,n),texcoord:d(2,n),normal:d(3,n),color:d(4,n,Uint8Array),indices:d(3,n/3,Uint16Array)};o.position.push(e),o.texcoord.push([.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0]),o.normal.push(t),o.color.push(r);for(var i=0;i<n;++i)o.indices.push(i);return o}function w(e,t,r,n,o,i,a){if(o<=0)throw Error("subdivisionDown must be > 0");i=i||0;var u=2,c=(a=a||1)-i,f=2*(o+1)*(2+u),l=d(3,f),m=d(3,f),p=d(2,f);function h(e,t,r){return e+(t-e)*r}function y(t,r,a,f,d,y){for(var v=0;v<=o;v++){var b=r/(u-1),E=v/o,_=2*(b-.5),x=(i+E*c)*Math.PI,g=Math.sin(x),T=Math.cos(x),A=h(e,t,g),P=_*n,C=T*e,R=g*A;l.push(P,C,R);var w=s.add(s.multiply([0,g,T],a),f);m.push(w),p.push(b*d+y,E)}}for(var v=0;v<u;v++){var b=2*(v/(u-1)-.5);y(t,v,[1,1,1],[0,0,0],1,0),y(t,v,[0,0,0],[b,0,0],0,0),y(r,v,[1,1,1],[0,0,0],1,0),y(r,v,[0,0,0],[b,0,0],0,1)}var E=d(3,2*o*(2+u),Uint16Array);function _(e,t){for(var r=0;r<o;++r)E.push(e+r+0,e+r+1,t+r+0),E.push(e+r+1,t+r+1,t+r+0)}var x=o+1;return _(0*x,4*x),_(5*x,7*x),_(6*x,2*x),_(3*x,1*x),{position:l,normal:m,texcoord:p,indices:E}}function F(e,t,r,n,o,i){return P(e,e,t,r,n,o,i)}function M(e,t,r,n,o,i){if(r<3)throw Error("radialSubdivisions must be 3 or greater");if(n<3)throw Error("verticalSubdivisions must be 3 or greater");o=o||0;for(var a=(i=i||2*Math.PI)-o,s=r+1,u=n+1,c=s*u,f=d(3,c),l=d(3,c),m=d(2,c),p=d(3,r*n*2,Uint16Array),h=0;h<u;++h)for(var y=h/n,v=y*Math.PI*2,b=Math.sin(v),E=e+b*t,_=Math.cos(v),x=_*t,g=0;g<s;++g){var T=g/r,A=o+T*a,P=Math.sin(A),C=Math.cos(A),R=P*E,w=C*E,F=P*b,M=C*b;f.push(R,x,w),l.push(F,_,M),m.push(T,1-y)}for(var B=0;B<n;++B)for(var I=0;I<r;++I){var U=1+I,O=1+B;p.push(s*B+I,s*O+I,s*B+U),p.push(s*O+I,s*O+U,s*B+U)}return{position:f,normal:l,texcoord:m,indices:p}}function B(e,t,r,n,o){if(t<3)throw Error("divisions must be at least 3");r=r||1,o=o||1,n=n||0;for(var i=(t+1)*(r+1),a=d(3,i),s=d(3,i),u=d(2,i),c=d(3,r*t*2,Uint16Array),f=0,l=e-n,m=t+1,p=0;p<=r;++p){for(var h=n+l*Math.pow(p/r,o),y=0;y<=t;++y){var v=2*Math.PI*y/t,b=h*Math.cos(v),E=h*Math.sin(v);if(a.push(b,0,E),s.push(0,1,0),u.push(1-y/t,p/r),p>0&&y!==t){var _=f+(y+1),x=f+y,g=f+y-m,T=f+(y+1)-m;c.push(_,x,g),c.push(_,g,T)}}f+=t+1}return{position:a,normal:s,texcoord:u,indices:c}}function I(e){return function(t){var r=e.apply(this,Array.prototype.slice.call(arguments,1));return n.createBuffersFromArrays(t,r)}}function U(e){return function(t){var r=e.apply(null,Array.prototype.slice.call(arguments,1));return n.createBufferInfoFromArrays(t,r)}}var O=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function S(e,t,r,n){n=n||0;for(var o=e.length,i=0;i<o;++i)t[r+i]=e[i]+n}function k(e,t){var r=c(e),n=new r.constructor(t),i=n;return r.numComponents&&r.numElements&&l(n,r.numComponents),e.data&&(i={data:n},o.copyNamedProperties(O,e,i)),i}var z=U(R);t.create3DFBufferInfo=z;var D=I(R);t.create3DFBuffers=D;var L=U(A);t.createCubeBufferInfo=L;var N=I(A);t.createCubeBuffers=N;var j=U(x);t.createPlaneBufferInfo=j;var X=I(x);t.createPlaneBuffers=X;var G=U(g);t.createSphereBufferInfo=G;var V=I(g);t.createSphereBuffers=V;var Y=U(P);t.createTruncatedConeBufferInfo=Y;var W=I(P);t.createTruncatedConeBuffers=W;var K=U(_);t.createXYQuadBufferInfo=K;var q=I(_);t.createXYQuadBuffers=q;var H=U(w);t.createCresentBufferInfo=H;var Q=I(w);t.createCresentBuffers=Q;var Z=U(F);t.createCylinderBufferInfo=Z;var $=I(F);t.createCylinderBuffers=$;var J=U(M);t.createTorusBufferInfo=J;var ee=I(M);t.createTorusBuffers=ee;var te=U(B);t.createDiscBufferInfo=te;var re=I(B);t.createDiscBuffers=re},function(e,t,r){"use strict";t.__esModule=!0;var n={addExtensionsToContext:!0,getContext:!0,getWebGLContext:!0,resizeCanvasToDisplaySize:!0,setDefaults:!0};t.addExtensionsToContext=b,t.getContext=function(e,t){return function(e,t){for(var r=["webgl2","webgl","experimental-webgl"],n=null,o=0;o<r.length;++o)if(n=e.getContext(r[o],t)){p.addExtensionsToContext&&b(n);break}return n}(e,t)},t.getWebGLContext=function(e,t){return function(e,t){for(var r=["webgl","experimental-webgl"],n=null,o=0;o<r.length;++o)if(n=e.getContext(r[o],t)){p.addExtensionsToContext&&b(n);break}return n}(e,t)},t.resizeCanvasToDisplaySize=function(e,t){t=t||1,t=Math.max(0,t);var r=e.clientWidth*t|0,n=e.clientHeight*t|0;if(e.width!==r||e.height!==n)return e.width=r,e.height=n,!0;return!1},t.setDefaults=function(e){a.copyExistingProperties(e,p),o.setAttributeDefaults_(e),i.setTextureDefaults_(e)};var o=m(r(7));Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=o[e]))});var i=m(r(8));Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=i[e]))});var a=m(r(0)),s=m(r(4));Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=s[e]))});var u=r(12);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=u[e]))});var c=r(13);Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=c[e]))});var f=r(5);Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=f[e]))});var l=r(1);Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=l[e]))});var d=r(14);function m(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}Object.keys(d).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=d[e]))});var p={addExtensionsToContext:!0};var h=/^(.*?)_/;function y(e,t){s.glEnumToString(e,0);var r=e.getExtension(t);if(r){var n={},o=h.exec(t)[1],i="_"+o;for(var u in r){var c=r[u],f="function"==typeof c,l=f?o:i,d=u;u.endsWith(l)&&(d=u.substring(0,u.length-l.length)),void 0!==e[d]?f||e[d]===c||a.warn(d,e[d],c,u):f?e[d]=function(e){return function(){return e.apply(r,arguments)}}(c):(e[d]=c,n[d]=c)}n.constructor={name:r.constructor.name},s.glEnumToString(n,0)}return r}var v=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function b(e){for(var t=0;t<v.length;++t)y(e,v[t])}},function(e,t,r){"use strict";t.__esModule=!0,t.drawBufferInfo=o,t.drawObjectList=function(e,t){var r=null,i=null;t.forEach(function(t){if(!1!==t.active){var a=t.programInfo,s=t.vertexArrayInfo||t.bufferInfo,u=!1,c=void 0===t.type?e.TRIANGLES:t.type;a!==r&&(r=a,e.useProgram(a.program),u=!0),(u||s!==i)&&(i&&i.vertexArrayObject&&!s.vertexArrayObject&&e.bindVertexArray(null),i=s,n.setBuffersAndAttributes(e,a,s)),n.setUniforms(a,t.uniforms),o(e,s,c,t.count,t.offset,t.instanceCount)}}),i.vertexArrayObject&&e.bindVertexArray(null)};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}(r(5));function o(e,t,r,n,o,i){r=void 0===r?e.TRIANGLES:r;var a=t.indices,s=t.elementType,u=void 0===n?t.numElements:n;o=void 0===o?0:o,s||a?void 0!==i?e.drawElementsInstanced(r,u,void 0===s?e.UNSIGNED_SHORT:t.elementType,o,i):e.drawElements(r,u,void 0===s?e.UNSIGNED_SHORT:t.elementType,o):void 0!==i?e.drawArraysInstanced(r,o,u,i):e.drawArrays(r,o,u)}},function(e,t,r){"use strict";t.__esModule=!0,t.bindFramebufferInfo=function(e,t,r){r=r||e.FRAMEBUFFER,t?(e.bindFramebuffer(r,t.framebuffer),e.viewport(0,0,t.width,t.height)):(e.bindFramebuffer(r,null),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight))},t.createFramebufferInfo=function(e,t,r,i){var f=e.FRAMEBUFFER,l=e.createFramebuffer();e.bindFramebuffer(f,l),r=r||e.drawingBufferWidth,i=i||e.drawingBufferHeight;var d=0,m={framebuffer:l,attachments:[],width:r,height:i};return(t=t||s).forEach(function(t){var s=t.attachment,l=t.format,p=function(e){return u[e]}(l);if(p||(p=a+d++),!s)if(function(e){return c[e]}(l))s=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,s),e.renderbufferStorage(e.RENDERBUFFER,l,r,i);else{var h=Object.assign({},t);h.width=r,h.height=i,void 0===h.auto&&(h.auto=!1,h.min=h.min||h.minMag||e.LINEAR,h.mag=h.mag||h.minMag||e.LINEAR,h.wrapS=h.wrapS||h.wrap||e.CLAMP_TO_EDGE,h.wrapT=h.wrapT||h.wrap||e.CLAMP_TO_EDGE),s=n.createTexture(e,h)}if(o.isRenderbuffer(e,s))e.framebufferRenderbuffer(f,p,e.RENDERBUFFER,s);else{if(!o.isTexture(e,s))throw"unknown attachment type";e.framebufferTexture2D(f,p,t.texTarget||e.TEXTURE_2D,s,t.level||0)}m.attachments.push(s)}),m},t.resizeFramebufferInfo=function(e,t,r,i,a){i=i||e.drawingBufferWidth,a=a||e.drawingBufferHeight,t.width=i,t.height=a,(r=r||s).forEach(function(r,s){var u=t.attachments[s],c=r.format;if(o.isRenderbuffer(e,u))e.bindRenderbuffer(e.RENDERBUFFER,u),e.renderbufferStorage(e.RENDERBUFFER,c,i,a);else{if(!o.isTexture(e,u))throw"unknown attachment type";n.resizeTexture(e,u,r,i,a)}})};var n=i(r(8)),o=i(r(0));function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var a=36064,s=[{format:6408,type:5121,min:9729,wrap:33071},{format:34041}],u={};u[34041]=33306,u[6401]=36128,u[36168]=36128,u[6402]=36096,u[33189]=36096;var c={};c[32854]=!0,c[32855]=!0,c[36194]=!0,c[34041]=!0,c[33189]=!0,c[6401]=!0,c[36168]=!0},function(e,t,r){"use strict";t.__esModule=!0,t.createVertexArrayInfo=function(e,t,r){var o=e.createVertexArray();e.bindVertexArray(o),t.length||(t=[t]);return t.forEach(function(t){n.setBuffersAndAttributes(e,t,r)}),e.bindVertexArray(null),{numElements:r.numElements,elementType:r.elementType,vertexArrayObject:o}},t.createVAOAndSetAttributes=o,t.createVAOFromBufferInfo=function(e,t,r){return o(e,t.attribSetters||t,r.attribs,r.indices)};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}(r(5));function o(e,t,r,o){var i=e.createVertexArray();return e.bindVertexArray(i),n.setAttributes(t,r),o&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o),e.bindVertexArray(null),i}}])},e.exports=n()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(10),o=r(0),i=r(9),a=r(1);class s{constructor(e){this.renderer=e.renderer,this.canvas=e.canvas,this.gameMode=e.gameMode,this.frameCoroutine=this.makeFrameCoroutine(),this.queuedPiece=void 0,this.pickedPiece=void 0,this.pieces=[],this.canvas.addEventListener("click",e=>{const t=this.canvas.clientWidth/this.canvas.clientHeight,r=s.size.x+2,o=s.size.y+2,i=Math.max(r,r*t),a=Math.max(o,o/t),u=(e.offsetX/this.canvas.clientWidth-.5)*i,c=-(e.offsetY/this.canvas.clientHeight-.5)*a,f=Math.floor(u+s.size.x/2),l=Math.floor(c+s.size.y/2);f>=0&&f<s.size.x&&l>=0&&l<s.size.y&&this.pick(s.coordToIndex(new n.Coord2({x:f,y:l})))})}spawnPosition(e){return o.Coord3.add(e,new o.Coord3({x:0,y:0,z:this.renderer.cameraDistance+1}))}static xyToIndex(e,t){return e+t*s.size.x}static coordToIndex(e){return s.xyToIndex(e.x,e.y)}static indexToCoord(e){return new n.Coord2({x:e%s.size.x,y:Math.floor(e/s.size.x)})}static pieceHomePosition(e){return o.Coord3.fromCoord2(n.Coord2.add(n.Coord2.add(s.indexToCoord(e),s.size.scaled(-.5)),new n.Coord2({x:.5,y:.5})))}pick(e){const t=this.pieces[e];t&&!this.pickedPiece&&(this.pickedPiece=t,this.pickedPiece.setCloaked(!1))}getFreePieceIndex(){const e=Array.from(a.range(0,s.size.x*s.size.y)).sort((e,t)=>{const r=new n.Coord2({x:(s.size.x-1)/2,y:(s.size.y-1)/2});return r.x+=.1,r.x+=.2,n.Coord2.distance(s.indexToCoord(e),r)-n.Coord2.distance(s.indexToCoord(t),r)});for(const t of e)if(!this.pieces[t])return t}existingColors(){return Array.from(new Set(this.pieces.filter(e=>!!e).map(e=>e.color)))}allColors(){return Array.from(a.range(0,s.numColors))}*makeFrameCoroutine(){const e=this.gameFlowCoroutine();for(;;){const t=yield,r=this.pieces.filter(e=>!!e).map(e=>e.frameCoroutine),n=e.next(t).done;if([...this.queuedPiece?[this.queuedPiece.frameCoroutine]:[],...r].forEach(e=>e.next(t)),n)return}}*gameFlowCoroutine(){for(yield*a.waitMs(1e3),yield*this.initializationCoroutine();;){if(this.pickedPiece&&this.queuedPiece){const e=new o.Coord3({x:0,y:0,z:this.renderer.cameraDistance/2}),t=o.Coord3.add(e,new o.Coord3({x:.5,y:0,z:0})),r=o.Coord3.add(e,new o.Coord3({x:-.5,y:0,z:0})),n=this.pickedPiece.position;if(this.queuedPiece.cancelAnimations(),yield*a.parallel([this.pickedPiece.makeCloakCoroutine(!1),this.queuedPiece.makeCloakCoroutine(!1)]),yield*a.parallel([this.queuedPiece.makeMoveCoroutine(t,500),this.pickedPiece.makeMoveCoroutine(r,500)]),yield*a.waitMs(500),this.pickedPiece.color==this.queuedPiece.color){if(this.gameMode.onUnlockedPair(this),this.pieces=this.pieces.map(e=>e!=this.pickedPiece?e:void 0),this.pieces.filter(e=>!!e).length<2)return void this.gameMode.onWin(this)}else{const e=this.getFreePieceIndex();if(void 0===e)return void this.gameMode.onGameOver(this);const t=s.pieceHomePosition(e);yield*a.parallel([this.queuedPiece.makeMoveCoroutine(t,500),this.queuedPiece.makeCloakCoroutine(!0,500),this.pickedPiece.makeMoveCoroutine(n,500),this.pickedPiece.makeCloakCoroutine(!0,500)]),this.pieces[e]=this.queuedPiece}this.queuedPiece=new i.Piece({renderer:this.renderer,position:this.spawnPosition(s.queuePosition),color:a.randomElement(this.existingColors().filter(e=>e!=(this.queuedPiece&&this.queuedPiece.color)&&e!=(this.pickedPiece&&this.pickedPiece.color)))||this.existingColors()[0]}),this.queuedPiece.move(s.queuePosition,500),this.queuedPiece.setCloaked(!0,1e4),this.pickedPiece.setCloaked(!0),this.pickedPiece=void 0}yield}}*initializationCoroutine(){for(let e=0;e<s.size.x*s.size.y*.75;++e){const e=a.randomElement(this.allColors()),t=this.getFreePieceIndex()||0,r=o.Coord3.fromCoord2(n.Coord2.add(n.Coord2.add(s.indexToCoord(t),s.size.scaled(-.5)),new n.Coord2({x:.5,y:.5}))),u=new i.Piece({renderer:this.renderer,position:this.spawnPosition(r),color:e});u.move(r,1e3),u.wait(1e3),u.setCloaked(!0,2e3),this.pieces[t]=u,yield*a.waitMs(100)}yield*a.waitMs(2e3),this.queuedPiece=new i.Piece({renderer:this.renderer,position:this.spawnPosition(s.queuePosition),color:a.randomElement(this.existingColors())}),yield*this.queuedPiece.makeMoveCoroutine(s.queuePosition,500),this.queuedPiece.setCloaked(!0,1e4)}draw(){this.renderer.clear(),this.queuedPiece&&this.queuedPiece.draw();for(const e of this.pieces)e&&e.draw()}}s.size=new n.Coord2({x:4,y:4}),s.numColors=13,s.queuePosition=o.Coord3.fromCoord2(n.Coord2.add(s.size.scaled(.5),new n.Coord2({x:.5,y:.5}))),t.Board=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3);t.GameMode1p=class{constructor(e){this.board=new n.Board({renderer:e.renderer,canvas:e.canvas,gameMode:this}),this.frameCoroutine=this.makeFrameCoroutine()}onUnlockedPair(e){}onGameOver(e){alert("game over")}onWin(e){alert("you won")}*makeFrameCoroutine(){for(;;){const e=yield;if(this.board.frameCoroutine.next(e).done)return}}draw(){this.board.draw()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2);t.TriangleSoup=class{constructor(e){const t=3*e;this.positions=n.primitives.createAugmentedTypedArray(3,t),this.texCoords=n.primitives.createAugmentedTypedArray(3,t),this.normals=n.primitives.createAugmentedTypedArray(3,t),this.arrays={position:{numComponents:3,data:this.positions.buffer},texCoord:{numComponents:3,data:this.texCoords.buffer},normal:{numComponents:3,data:this.normals.buffer}}}push(e){for(const t of e)this.positions.push(t.position.x,t.position.y,t.position.z),this.texCoords.push(t.texCoord.x,t.texCoord.y,t.texCoord.z),this.normals.push(t.normal.x,t.normal.y,t.normal.z)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(1),i=r(5);t.CloakMesh=class{constructor(e,t,r){this.uTesselation=r,this.vTesselation=4*r,this.innerRadius=e,this.thickness=t}tesselate(e){const t=new n.Coord3({x:0,y:1,z:0}),r=new n.Coord3({x:-1,y:0,z:0}),a=r.scaled(this.innerRadius+this.thickness),s=this.uTesselation,u=new i.TriangleSoup(this.uTesselation*this.vTesselation*2+this.vTesselation+s*this.vTesselation*2),c=[];for(let n=0;n<=this.vTesselation;++n){const i=n/this.vTesselation;c[n]=[];for(let s=0;s<=this.uTesselation;++s){const u=s/this.uTesselation,f=o.axisRotate(r,o.axisRotate(t,a,180*u*e),360*i),l=f.normalized();c[n][s]={position:f,normal:l,texCoord:l}}}for(let e=0;e<this.vTesselation;++e)for(let t=0;t<this.uTesselation;++t)u.push([c[e+0][t+0],c[e+0][t+1],c[e+1][t+0]]),u.push([c[e+1][t+0],c[e+0][t+1],c[e+1][t+1]]);{const e=a.normalized(),t={position:a,normal:e,texCoord:e};for(let e=0;e<this.vTesselation;++e)u.push([c[e][0],c[e+1][0],t])}{const i=this.thickness/2,a=r.scaled(this.innerRadius+i),c=[];for(let u=0;u<=this.vTesselation;++u){const f=u/this.vTesselation;c[u]=[];for(let l=0;l<=s;++l){const d=l/s,m=o.axisRotate(r,o.axisRotate(t,n.Coord3.add(o.axisRotate(t,r.scaled(i),180*d),a),180*e),360*f),p=o.axisRotate(r,o.axisRotate(t,r,180*d+180*e),360*f);c[u][l]={position:m,normal:p,texCoord:p}}}for(let e=0;e<this.vTesselation;++e)for(let t=0;t<s;++t)u.push([c[e+0][t+0],c[e+0][t+1],c[e+1][t+0]]),u.push([c[e+1][t+0],c[e+0][t+1],c[e+1][t+1]])}return u.arrays}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textureInfo=(e=>({earth:{target:e.TEXTURE_CUBE_MAP,src:"graphics/earth.jpg"},globe:{target:e.TEXTURE_CUBE_MAP,src:"graphics/globe.jpg"},eye:{target:e.TEXTURE_CUBE_MAP,src:"graphics/eye.jpg"},oneBall:{target:e.TEXTURE_CUBE_MAP,src:"graphics/1-ball.jpg"},thirteenBall:{target:e.TEXTURE_CUBE_MAP,src:"graphics/13-ball.jpg"},volley:{target:e.TEXTURE_CUBE_MAP,src:"graphics/volley.jpg"},tennis:{target:e.TEXTURE_CUBE_MAP,src:"graphics/tennis.jpg"},soccer:{target:e.TEXTURE_CUBE_MAP,src:"graphics/soccer.jpg"},animator:{target:e.TEXTURE_CUBE_MAP,src:"graphics/animator.jpg"},jupiter:{target:e.TEXTURE_CUBE_MAP,src:"graphics/jupiter.jpg"},poke:{target:e.TEXTURE_CUBE_MAP,src:"graphics/poke.png"},balance:{target:e.TEXTURE_CUBE_MAP,src:"graphics/balance.jpg"},basket:{target:e.TEXTURE_CUBE_MAP,src:"graphics/basket.jpg"},hidden:{target:e.TEXTURE_CUBE_MAP,src:"graphics/hidden.jpg"}}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vertexShader="\n\tuniform mat4 u_worldViewProjection;\n\tuniform vec3 u_lightWorldPos;\n\tuniform mat4 u_world;\n\tuniform mat4 u_model;\n\tuniform mat4 u_viewInverse;\n\tuniform mat4 u_worldInverseTranspose;\n\n\tattribute vec4 position;\n\tattribute vec3 normal;\n\tattribute vec3 texCoord;\n\n\tvarying vec4 v_position;\n\tvarying vec3 v_normal;\n\tvarying vec3 v_texCoord;\n\tvarying vec3 v_surfaceToLight;\n\tvarying vec3 v_surfaceToView;\n\n\tvoid main() {\n\t\tv_position = u_worldViewProjection * u_model * position;\n\t\tv_normal = (u_worldInverseTranspose * u_model * vec4(normal, 0)).xyz;\n\t\tv_texCoord = texCoord;\n\t\tv_surfaceToLight = u_lightWorldPos - (u_world * position).xyz;\n\t\tv_surfaceToView = (u_viewInverse[3] - (u_world * position)).xyz;\n\t\tgl_Position = v_position;\n\t}\n",t.fragmentShader="\n\tprecision mediump float;\n\n\tvarying vec4 v_position;\n\tvarying vec3 v_normal;\n\tvarying vec3 v_texCoord;\n\tvarying vec3 v_surfaceToLight;\n\tvarying vec3 v_surfaceToView;\n\n\tuniform vec4 u_lightColor;\n\tuniform vec4 u_ambient;\n\tuniform vec4 u_specular;\n\tuniform float u_shininess;\n\tuniform float u_specularFactor;\n\tuniform samplerCube u_diffuseMap;\n\n\tvec4 lit(float l ,float h, float m) {\n\t\treturn vec4(\n\t\t\t1.0,\n\t\t\tmax(l, 0.0),\n\t\t\t(l > 0.0) ? pow(max(0.0, h), m) : 0.0,\n\t\t\t1.0\n\t\t);\n\t}\n\n\tvoid main() {\n\t\tvec4 diffuseColor = textureCube(u_diffuseMap, normalize(v_texCoord));\n\t\tvec3 a_normal = normalize(v_normal);\n\t\tvec3 surfaceToLight = normalize(v_surfaceToLight);\n\t\tvec3 surfaceToView = normalize(v_surfaceToView);\n\t\tvec3 halfVector = normalize(surfaceToLight + surfaceToView);\n\t\tvec4 litR = lit(\n\t\t\tdot(a_normal, surfaceToLight),\n\t\t\tdot(a_normal, halfVector),\n\t\t\tu_shininess\n\t\t);\n\t\tvec4 outColor = vec4(\n\t\t\t(u_lightColor * (\n\t\t\t\tdiffuseColor * litR.y + diffuseColor * u_ambient +\n\t\t\t\tu_specular * litR.z * u_specularFactor\n\t\t\t)).rgb,\n\t\t\tdiffuseColor.a\n\t\t);\n\t\tgl_FragColor = outColor;\n\t}\n"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(1);t.Piece=class{constructor(e){this.renderer=e.renderer,this.position=e.position,this.color=e.color,this.cloakFactor=0,this.animationQueue=[],this.frameCoroutine=this.makeFrameCoroutine()}cancelAnimations(){this.animationQueue=[],this.frameCoroutine=this.makeFrameCoroutine()}*makeFrameCoroutine(){for(;;){const e=this.animationQueue.shift();if(!e){yield;continue}let t=!1;for(;!t;){const r=yield;t=e.next(r).done}}}setCloaked(e,t){this.animationQueue.push(this.makeCloakCoroutine(e,t))}*makeCloakCoroutine(e,t=500){const r=this.cloakFactor,n=e?1:0;yield*o.animateInterpolation(t,e=>{this.cloakFactor=r*(1-e)+n*e})}move(e,t){this.animationQueue.push(this.makeMoveCoroutine(e,t))}*makeMoveCoroutine(e,t,r=o.easings.inOutCubic){const i=this.position,a=e;yield*o.animateInterpolation(t,e=>{this.position=n.Coord3.interpolate(i,a,r(e))})}wait(e){this.animationQueue.push(o.waitMs(e))}draw(){this.cloakFactor<1&&this.renderer.drawSphere(this.color,this.position),this.cloakFactor>0&&this.renderer.drawCloak(this.position,this.cloakFactor)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.x=e.x,this.y=e.y}scaled(e){return n.scale(this,e)}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalized(){return n.scale(this,1/this.length())}static distance(e,t){return n.subtract(e,t).length()}static add(e,t){return new n({x:e.x+t.x,y:e.y+t.y})}static subtract(e,t){return new n({x:e.x-t.x,y:e.y-t.y})}static scale(e,t){return new n({x:e.x*t,y:e.y*t})}static interpolate(e,t,r){return n.add(n.scale(e,1-r),n.scale(t,r))}}t.Coord2=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2),o=r(1),i=r(3),a=r(8),s=r(7),u=r(6);t.Renderer=class{constructor(e){this.gl=e.getContext("webgl");const t=n.createProgramFromSources(this.gl,[a.vertexShader,a.fragmentShader]);this.programInfo=n.createProgramInfoFromProgram(this.gl,t),this.sphereMeshBufferInfo=n.createBufferInfoFromArrays(this.gl,o.meshToWebglArrays(o.makeTesselatedSphereMesh(.4,8))),this.cloakMesh=new u.CloakMesh(.4,.05,8),this.partialCloakMeshBufferInfo=n.createBufferInfoFromArrays(this.gl,this.cloakMesh.tesselate(0)),this.fullCloakMeshBufferInfo=n.createBufferInfoFromArrays(this.gl,o.meshToWebglArrays(o.makeTesselatedSphereMesh(.45,8))),n.resizeCanvasToDisplaySize(e,window.devicePixelRatio),this.gl.enable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.CULL_FACE),this.textures=n.createTextures(this.gl,s.textureInfo(this.gl)),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.useProgram(this.programInfo.program);const r=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight,c=i.Board.size.x+2,f=i.Board.size.y+2,l=Math.max(c,f/r)/2,d=Math.PI/180*20;this.cameraDistance=Math.max(c,f)/2/Math.tan(d/2);const m=2*Math.atan(l/this.cameraDistance),p=n.m4.perspective(m,r,.5,30),h=[0,0,this.cameraDistance],y=n.m4.lookAt(h,[0,0,0],[0,1,0]),v=n.m4.inverse(y),b=n.m4.multiply(p,v),E=n.m4.rotationY(0);n.setUniforms(this.programInfo,{u_lightWorldPos:[-4,8,10],u_lightColor:[1,.8,.8,1],u_ambient:[.5,.5,.5,1],u_specular:[.5,.5,.5,1],u_shininess:50,u_specularFactor:1,u_viewInverse:y,u_world:E,u_worldInverseTranspose:n.m4.transpose(n.m4.inverse(E)),u_worldViewProjection:n.m4.multiply(b,E)}),this.clear()}clear(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}drawSphere(e,t){const r=n.m4.multiply(n.m4.translation([t.x,t.y,t.z,0]),n.m4.multiply(n.m4.rotationY((new Date).getTime()/1e3),n.m4.rotationX((new Date).getTime()/1341)));n.setUniforms(this.programInfo,{u_model:r,u_diffuseMap:this.textures[Object.keys(this.textures)[e%Object.keys(this.textures).length]]}),n.setBuffersAndAttributes(this.gl,this.programInfo,this.sphereMeshBufferInfo),n.drawBufferInfo(this.gl,this.sphereMeshBufferInfo)}drawCloak(e,t){const r=n.m4.multiply(n.m4.translation([e.x,e.y,e.z,0]),n.m4.multiply(n.m4.rotationY((new Date).getTime()/1e3),n.m4.rotationX((new Date).getTime()/1341)));if(n.setUniforms(this.programInfo,{u_model:r,u_diffuseMap:this.textures[Object.keys(this.textures)[Object.keys(this.textures).length-1]]}),1==t)n.setBuffersAndAttributes(this.gl,this.programInfo,this.fullCloakMeshBufferInfo),n.drawBufferInfo(this.gl,this.fullCloakMeshBufferInfo);else{const e=this.cloakMesh.tesselate(t);n.setAttribInfoBufferFromArray(this.gl,this.partialCloakMeshBufferInfo.attribs.position,e.position),n.setAttribInfoBufferFromArray(this.gl,this.partialCloakMeshBufferInfo.attribs.normal,e.normal),n.setAttribInfoBufferFromArray(this.gl,this.partialCloakMeshBufferInfo.attribs.texCoord,e.texCoord),n.setBuffersAndAttributes(this.gl,this.programInfo,this.partialCloakMeshBufferInfo),n.drawBufferInfo(this.gl,this.partialCloakMeshBufferInfo)}}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,s)}u((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const o=r(11),i=r(4);t.App=class{constructor(){this.canvas=document.getElementsByTagName("canvas")[0],this.renderer=new o.Renderer(this.canvas),this.gameMode=new i.GameMode1p({renderer:this.renderer,canvas:this.canvas}),this.lastRenderTime=0}startGame(){return n(this,void 0,void 0,function*(){const e=()=>new Promise(e=>{(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||(e=>{window.setTimeout(e,1e3/60,(new Date).getTime())}))(e)});for(;;){const t=yield e(),r=Math.min(t-this.lastRenderTime,100);this.lastRenderTime=t;const n=this.gameMode.frameCoroutine.next(r).done;this.gameMode.draw(),n&&(this.gameMode=new i.GameMode1p({renderer:this.renderer,canvas:this.canvas}))}})}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,s)}u((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const o=new(r(12).App);(()=>n(this,void 0,void 0,function*(){yield o.startGame()}))()}]);